<!-- htmlhint doctype-first:false -->
{% if rules %}
<div
  x-data="{
    selectedRules: [],
    expandedRules: {},
    allRuleIndices: {{ rule_indices | tojson }},
    toggleExpanded(ruleIndex) {
      this.expandedRules[ruleIndex] = !this.expandedRules[ruleIndex];
    },
    isExpanded(ruleIndex) {
      return this.expandedRules[ruleIndex] || false;
    },
    toggleAll() {
      if (this.selectedRules.length === this.allRuleIndices.length) {
        this.selectedRules = [];
      } else {
        this.selectedRules = [...this.allRuleIndices];
      }
    },
    async deleteSelected() {
      if (this.selectedRules.length === 0) return;

      const count = this.selectedRules.length;
      if (!confirm(`Are you sure you want to delete ${count} routing rule${count > 1 ? 's' : ''}?`)) {
        return;
      }

      try {
        const response = await fetch('{{ root_path }}/admin/plugin-routing/rules/bulk-delete', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ indices: this.selectedRules })
        });

        if (response.ok) {
          // Update the rules list with the response HTML
          const html = await response.text();
          document.getElementById('routing-rules-list').innerHTML = html;
          this.selectedRules = [];
        } else {
          alert('Failed to delete rules: ' + await response.text());
        }
      } catch (error) {
        alert('Error deleting rules: ' + error.message);
      }
    }
  }"
  class="overflow-x-auto"
>
  <!-- How Rules Work - Info Box -->
  <div class="bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-400 dark:border-blue-600 px-6 py-4 mb-4 mx-6 mt-4 rounded-r-md">
    <div class="flex items-start">
      <div class="flex-shrink-0">
        <svg class="h-5 w-5 text-blue-400 dark:text-blue-500 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="ml-3">
        <h3 class="text-sm font-semibold text-blue-900 dark:text-blue-100 mb-1">How Routing Rules Work</h3>
        <div class="text-sm text-blue-800 dark:text-blue-200 space-y-1">
          <p><strong>Most Specific Rule Wins:</strong> When multiple rules could apply to an entity, only the most specific rule takes effect.</p>
          <p><strong>Specificity Order:</strong> Entity Name (highest) → Tags → Entity Type → Global (lowest)</p>
          <p><strong>Plugin Execution:</strong> Plugins within a rule execute in priority order (lower numbers first).</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Bulk Actions Bar -->
  <div
    x-show="selectedRules.length > 0"
    x-cloak
    class="bg-indigo-50 dark:bg-indigo-900/20 border-b border-indigo-200 dark:border-indigo-800 px-6 py-3 flex items-center justify-between"
  >
    <span class="text-sm font-medium text-indigo-900 dark:text-indigo-100">
      <span x-text="selectedRules.length"></span> rule<span x-show="selectedRules.length !== 1">s</span> selected
    </span>
    <button
      @click="deleteSelected()"
      class="inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
    >
      <svg class="h-4 w-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
      </svg>
      Delete Selected
    </button>
  </div>

  <!-- Grouped Rules Display -->
  {% set rule_groups = [
    ('global', 'Global Rules', 'Apply to all entities', 'bg-gray-100 dark:bg-gray-800', rules_by_type.global),
    ('entity-type', 'Entity Type Rules', 'Filter by entity type (tool, prompt, resource)', 'bg-blue-50 dark:bg-blue-900/20', rules_by_type['entity-type']),
    ('tag-based', 'Tag-Based Rules', 'Filter by entity tags', 'bg-green-50 dark:bg-green-900/20', rules_by_type['tag-based']),
    ('entity-specific', 'Entity-Specific Rules', 'Target specific named entities', 'bg-purple-50 dark:bg-purple-900/20', rules_by_type['entity-specific']),
    ('mixed', 'Mixed Filter Rules', 'Combine multiple filter types', 'bg-yellow-50 dark:bg-yellow-900/20', rules_by_type.mixed)
  ] %}

  {% for group_id, group_title, group_desc, group_bg, group_rules in rule_groups %}
    {% if group_rules %}
    <div class="mb-6">
      <!-- Group Header -->
      <div class="{{ group_bg }} px-6 py-3 border-b border-gray-200 dark:border-gray-700">
        <div class="flex items-center justify-between">
          <div>
            <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider">
              {{ group_title }}
            </h3>
            <p class="text-xs text-gray-600 dark:text-gray-400 mt-0.5">{{ group_desc }}</p>
          </div>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
            {{ group_rules|length }} rule{{ 's' if group_rules|length != 1 else '' }}
          </span>
        </div>
      </div>

      <!-- Rules Table for this Group -->
      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-700">
          <tr>
            <th scope="col" class="px-6 py-3 text-left w-12">
              <input
                type="checkbox"
                @change="() => {
                  const groupIndices = {{ group_rules | map(attribute='index') | list | tojson }};
                  const allSelected = groupIndices.every(i => selectedRules.includes(i));
                  if (allSelected) {
                    selectedRules = selectedRules.filter(i => !groupIndices.includes(i));
                  } else {
                    selectedRules = [...new Set([...selectedRules, ...groupIndices])];
                  }
                }"
                class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded cursor-pointer"
                title="Select all in group"
              />
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider w-12">
              <!-- Expand toggle -->
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
              Rule Name & Filters
            </th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
              Plugins
            </th>
            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
              Actions
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700">
          {% for rule in group_rules %}
          <tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50">
            <td class="px-6 py-4 whitespace-nowrap">
              <input
                type="checkbox"
                :value="{{ rule.index }}"
                x-model="selectedRules"
                class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded cursor-pointer"
              />
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <button
                @click="toggleExpanded({{ rule.index }})"
                class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
                title="Toggle details"
              >
                <svg class="h-5 w-5 transition-transform" :class="{ 'rotate-90': isExpanded({{ rule.index }}) }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </button>
            </td>
            <td class="px-6 py-4">
              <div class="space-y-2">
                <!-- Rule Name -->
                <div class="text-sm font-medium text-gray-900 dark:text-gray-100">
                  {{ rule.name }}
                  {% if rule.when %}
                  <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">
                    <svg class="h-3 w-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z" clip-rule="evenodd" />
                    </svg>
                    Conditional
                  </span>
                  {% endif %}
                </div>

                <!-- Filter Details -->
                <div class="text-xs space-y-1">
                  {% if rule.entity_type_filters %}
                  <div class="flex items-start">
                    <span class="text-gray-500 dark:text-gray-400 font-medium mr-2">Entity Types:</span>
                    <div class="flex flex-wrap gap-1">
                      {% for entity_type in rule.entity_type_filters %}
                        {% if entity_type == 'tool' %}
                          {% set color_class = 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' %}
                        {% elif entity_type == 'prompt' %}
                          {% set color_class = 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' %}
                        {% elif entity_type == 'resource' %}
                          {% set color_class = 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' %}
                        {% elif entity_type == 'agent' %}
                          {% set color_class = 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200' %}
                        {% elif entity_type == 'virtual_server' %}
                          {% set color_class = 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200' %}
                        {% elif entity_type == 'mcp_server' %}
                          {% set color_class = 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200' %}
                        {% else %}
                          {% set color_class = 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200' %}
                        {% endif %}
                        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium {{ color_class }}">
                          {{ entity_type }}
                        </span>
                      {% endfor %}
                    </div>
                  </div>
                  {% endif %}

                  {% if rule.name_filters %}
                  <div class="flex items-start">
                    <span class="text-gray-500 dark:text-gray-400 font-medium mr-2">Entity Names:</span>
                    <div class="flex flex-wrap gap-1">
                      {# Use name_filters_with_types if available (includes type info), otherwise fallback to name_filters #}
                      {% if rule.name_filters_with_types %}
                        {% for entity in rule.name_filters_with_types %}
                          {% if entity.type == 'tool' %}
                            {% set color_class = 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' %}
                          {% elif entity.type == 'prompt' %}
                            {% set color_class = 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' %}
                          {% elif entity.type == 'resource' %}
                            {% set color_class = 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' %}
                          {% elif entity.type == 'agent' %}
                            {% set color_class = 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200' %}
                          {% elif entity.type == 'virtual_server' %}
                            {% set color_class = 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200' %}
                          {% elif entity.type == 'mcp_server' %}
                            {% set color_class = 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200' %}
                          {% else %}
                            {% set color_class = 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200' %}
                          {% endif %}
                          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium {{ color_class }}">
                            {{ entity.name }}
                          </span>
                        {% endfor %}
                      {% else %}
                        {# Fallback: use entity type color if there's exactly one entity type #}
                        {% for name in rule.name_filters %}
                          {% if rule.entity_type_filters and rule.entity_type_filters|length == 1 %}
                            {% set entity_type = rule.entity_type_filters[0] %}
                            {% if entity_type == 'tool' %}
                              {% set color_class = 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' %}
                            {% elif entity_type == 'prompt' %}
                              {% set color_class = 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' %}
                            {% elif entity_type == 'resource' %}
                              {% set color_class = 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' %}
                            {% elif entity_type == 'agent' %}
                              {% set color_class = 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200' %}
                            {% elif entity_type == 'virtual_server' %}
                              {% set color_class = 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200' %}
                            {% elif entity_type == 'mcp_server' %}
                              {% set color_class = 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200' %}
                            {% else %}
                              {% set color_class = 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200' %}
                            {% endif %}
                          {% else %}
                            {# Multiple or no entity types - use purple for entity-specific names #}
                            {% set color_class = 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' %}
                          {% endif %}
                          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium {{ color_class }}">
                            {{ name }}
                          </span>
                        {% endfor %}
                      {% endif %}
                    </div>
                  </div>
                  {% endif %}

                  {% if rule.tags %}
                  <div class="flex items-start">
                    <span class="text-gray-500 dark:text-gray-400 font-medium mr-2">Tags:</span>
                    <div class="flex flex-wrap gap-1">
                      {% for tag in rule.tags %}
                        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                          {{ tag }}
                        </span>
                      {% endfor %}
                    </div>
                  </div>
                  {% endif %}

                  {% if rule.matching_entities %}
                  <div class="flex items-start">
                    <span class="text-gray-500 dark:text-gray-400 font-medium mr-2">Applies to:</span>
                    <div class="flex flex-wrap gap-1">
                      {% set total = rule.matching_entities|length %}
                      {% set display_entities = rule.matching_entities[:5] if total > 5 else rule.matching_entities %}
                      {% for entity in display_entities %}
                        {% if entity.type == 'tool' %}
                          {% set color_class = 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' %}
                        {% elif entity.type == 'prompt' %}
                          {% set color_class = 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200' %}
                        {% elif entity.type == 'resource' %}
                          {% set color_class = 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' %}
                        {% elif entity.type == 'agent' %}
                          {% set color_class = 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200' %}
                        {% elif entity.type == 'virtual_server' %}
                          {% set color_class = 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200' %}
                        {% elif entity.type == 'mcp_server' %}
                          {% set color_class = 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200' %}
                        {% else %}
                          {% set color_class = 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200' %}
                        {% endif %}
                        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium {{ color_class }}">
                          {{ entity.name }}
                        </span>
                      {% endfor %}
                      {% if total > 5 %}
                        <span class="text-xs text-gray-500 dark:text-gray-400">and {{ total - 5 }} more...</span>
                      {% endif %}
                    </div>
                  </div>
                  {% endif %}

                  {% if rule.when %}
                  <div class="flex items-start">
                    <span class="text-gray-500 dark:text-gray-400 font-medium mr-2">When:</span>
                    <code class="text-xs bg-gray-100 dark:bg-gray-700 px-1 py-0.5 rounded">{{ rule.when }}</code>
                  </div>
                  {% endif %}
                </div>
              </div>
            </td>
            <td class="px-6 py-4">
              <div class="text-sm text-gray-900 dark:text-gray-100">
                {% if rule.plugins %}
                  <div class="flex flex-wrap gap-1">
                    {% for plugin in rule.plugins %}
                      {% if plugin.enabled is defined and not plugin.enabled %}
                        <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200" title="Plugin is disabled">
                          {{ plugin.name }}
                          <span class="ml-1 text-red-600 dark:text-red-300">({{ plugin.priority }})</span>
                        </span>
                      {% else %}
                        <span class="inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200">
                          {{ plugin.name }}
                          <span class="ml-1 text-indigo-600 dark:text-indigo-300">({{ plugin.priority }})</span>
                        </span>
                      {% endif %}
                    {% endfor %}
                  </div>
                {% else %}
                  <span class="text-xs text-gray-400 dark:text-gray-500">None</span>
                {% endif %}
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
              <button
                onclick="window.dispatchEvent(new CustomEvent('open-rule-modal', { detail: { ruleIndex: {{ rule.index }} } }))"
                class="text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"
                title="Edit rule"
              >
                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
              </button>
            </td>
          </tr>

          <!-- Expanded Details Row -->
          <tr x-show="isExpanded({{ rule.index }})" x-collapse class="bg-gray-50 dark:bg-gray-900/50">
            <td colspan="5" class="px-6 py-4">
              <div class="pl-12">
                <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">Plugin Details</h4>

                {% if rule.plugins %}
                <div class="space-y-3">
                  {% for plugin in rule.plugins %}
                  <div class="bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700 p-3 {% if plugin.enabled is defined and not plugin.enabled %}opacity-60{% endif %}">
                    <div class="flex items-start justify-between">
                      <div class="flex-1">
                        <div class="flex items-center gap-2 mb-2">
                          <span class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ plugin.name }}</span>
                          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200">
                            Priority: {{ plugin.priority }}
                          </span>
                          {% if plugin.mode %}
                          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">
                            {{ plugin.mode }}
                          </span>
                          {% endif %}
                          {% if plugin.enabled is defined %}
                            {% if plugin.enabled %}
                          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                            Enabled
                          </span>
                            {% else %}
                          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200" title="This plugin is disabled in the configuration">
                            Disabled
                          </span>
                            {% endif %}
                          {% endif %}
                        </div>

                        <!-- Hooks -->
                        <div class="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                          <div class="flex items-start">
                            <span class="font-medium mr-2">Hooks:</span>
                            {% if plugin.hooks %}
                            <div class="flex flex-wrap gap-1 items-center">
                              {% for hook in plugin.hooks %}
                              <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                {{ hook }}
                              </span>
                              {% endfor %}
                              <span class="text-gray-500 dark:text-gray-400 text-xs ml-1">(override)</span>
                            </div>
                            {% elif plugin.default_hooks %}
                            <div class="flex flex-wrap gap-1 items-center">
                              {% for hook in plugin.default_hooks %}
                              <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300">
                                {{ hook }}
                              </span>
                              {% endfor %}
                              <span class="text-gray-500 dark:text-gray-400 text-xs ml-1">(defaults)</span>
                            </div>
                            {% else %}
                            <span class="text-gray-500 dark:text-gray-400 italic">No hooks configured</span>
                            {% endif %}
                          </div>

                          {% if plugin.when %}
                          <div class="flex items-start">
                            <span class="font-medium mr-2">When:</span>
                            <code class="bg-gray-100 dark:bg-gray-700 px-1 py-0.5 rounded">{{ plugin.when }}</code>
                          </div>
                          {% endif %}

                          {% if plugin.config %}
                          <div class="flex items-start">
                            <span class="font-medium mr-2">Config:</span>
                            <code class="bg-gray-100 dark:bg-gray-700 px-1 py-0.5 rounded">{{ plugin.config | tojson }}</code>
                          </div>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                  </div>
                  {% endfor %}
                </div>
                {% else %}
                <p class="text-sm text-gray-500 dark:text-gray-400 italic">No plugins configured</p>
                {% endif %}

                {% if rule.reverse_order_on_post %}
                <div class="mt-3 pt-3 border-t border-gray-200 dark:border-gray-700">
                  <div class="inline-flex items-center px-3 py-1.5 rounded-md bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200 text-sm">
                    <svg class="h-4 w-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                    </svg>
                    <strong>Reverse Order on Post-Hooks:</strong>&nbsp;Plugin execution order is reversed for post-hooks
                  </div>
                </div>
                {% endif %}
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  {% endfor %}
</div>
{% else %}
<div class="p-8 text-center">
  <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
  </svg>
  <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-gray-100">No routing rules</h3>
  <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
    Get started by creating a new routing rule.
  </p>
  <div class="mt-6">
    <button
      @click="$dispatch('open-rule-modal')"
      class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
    >
      <svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
      </svg>
      Create Rule
    </button>
  </div>
</div>
{% endif %}
