# JWT Claims Extraction Plugin Configuration
# Location: ./mcpgateway/plugins/jwt_claims_extraction/config.yaml

name: jwt_claims_extraction
version: 1.0.0
enabled: true
mode: permissive  # Permissive mode - extracts claims without blocking
priority: 10      # Low priority number = runs early

hooks:
  - http_auth_resolve_user

description: |
  Extracts JWT claims and metadata from access tokens and stores them
  in global context for downstream authorization plugins (Cedar, OPA).

  Supports:
  - Standard JWT claims (sub, iss, aud, exp, etc.)
  - Custom claims (roles, permissions, groups)
  - RFC 9396 rich authorization requests

  Claims are stored in: global_context.metadata["jwt_claims"]

tags:
  - auth
  - jwt
  - claims
  - rbac
  - abac
  - rfc9396

# Configuration options (optional)
options:
  # Reserved context key where claims will be stored
  context_key: jwt_claims

  # Log extracted claims (for debugging)
  log_claims: true

  # Extract RFC 9396 authorization_details
  extract_authorization_details: true
