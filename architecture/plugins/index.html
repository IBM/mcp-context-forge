<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="MCP Gateway Documentation"><meta name=author content="Mihai Criveti"><link href=https://pages.github.com/ibm/mcp-context-forge/architecture/plugins/ rel=canonical><link href=../security-features/ rel=prev><link href=../export-import-architecture/ rel=next><link rel=alternate type=application/rss+xml title="RSS feed" href=../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../feed_rss_updated.xml><link rel=icon href=../../favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.19"><title>Plugin Framework - MCP Context Forge - Model Context Protocol Gateway</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#plugin-framework-specification class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="MCP Context Forge - Model Context Protocol Gateway" class="md-header__button md-logo" aria-label="MCP Context Forge - Model Context Protocol Gateway" data-md-component=logo> <img src=../../logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MCP Context Forge - Model Context Protocol Gateway </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Plugin Framework </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ibm/mcp-context-forge title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> ibm/mcp-context-forge </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> 🏠 Home </a> </li> <li class=md-tabs__item> <a href=../../overview/ class=md-tabs__link> 🧭 Overview </a> </li> <li class=md-tabs__item> <a href=../../using/ class=md-tabs__link> 🧰 Use </a> </li> <li class=md-tabs__item> <a href=../../deployment/ class=md-tabs__link> 🚀 Deploy </a> </li> <li class=md-tabs__item> <a href=../../manage/ class=md-tabs__link> 🛡️ Manage </a> </li> <li class=md-tabs__item> <a href=../../development/ class=md-tabs__link> 💻 Develop </a> </li> <li class=md-tabs__item> <a href=../../testing/ class=md-tabs__link> 🧪 Test </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> 📐 Design &amp; Roadmap </a> </li> <li class=md-tabs__item> <a href=../../media/ class=md-tabs__link> 📰 Media </a> </li> <li class=md-tabs__item> <a href=../../tutorials/ class=md-tabs__link> 📖 Tutorials </a> </li> <li class=md-tabs__item> <a href=../../best-practices/mcp-best-practices/ class=md-tabs__link> ⭐ Best Practices </a> </li> <li class=md-tabs__item> <a href=../../faq/ class=md-tabs__link> ❓ FAQ </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="MCP Context Forge - Model Context Protocol Gateway" class="md-nav__button md-logo" aria-label="MCP Context Forge - Model Context Protocol Gateway" data-md-component=logo> <img src=../../logo.png alt=logo> </a> MCP Context Forge - Model Context Protocol Gateway </label> <div class=md-nav__source> <a href=https://github.com/ibm/mcp-context-forge title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> ibm/mcp-context-forge </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> 🏠 Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../overview/ class="md-nav__link "> <span class=md-ellipsis> 🧭 Overview </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 🧭 Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../overview/quick_start/ class=md-nav__link> <span class=md-ellipsis> 🚀 Quick Start </span> <span class="md-status md-status--draft"></span> </a> </li> <li class=md-nav__item> <a href=../../overview/features/ class=md-nav__link> <span class=md-ellipsis> ✨ Features Overview </span> </a> </li> <li class=md-nav__item> <a href=../../overview/ui/ class=md-nav__link> <span class=md-ellipsis> Admin UI </span> </a> </li> <li class=md-nav__item> <a href=../../overview/ui-concepts/ class=md-nav__link> <span class=md-ellipsis> Admin Console Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../overview/passthrough/ class=md-nav__link> <span class=md-ellipsis> HTTP Header Passthrough </span> </a> </li> <li class=md-nav__item> <a href=../../overview/tags/ class=md-nav__link> <span class=md-ellipsis> 🏷️ Tags System </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../using/ class="md-nav__link "> <span class=md-ellipsis> 🧰 Use </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 🧰 Use </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/mcpgateway-wrapper/ class=md-nav__link> <span class=md-ellipsis> 🛠 STDIO Wrapper (mcpgateway.wrapper) </span> </a> </li> <li class=md-nav__item> <a href=../../using/mcpgateway-translate/ class=md-nav__link> <span class=md-ellipsis> MCP Gateway Transport Bridge (mcpgateway.translate) </span> </a> </li> <li class=md-nav__item> <a href=../../using/reverse-proxy/ class=md-nav__link> <span class=md-ellipsis> MCP Reverse Proxy </span> </a> </li> <li class=md-nav__item> <a href=../../using/multi-auth-headers/ class=md-nav__link> <span class=md-ellipsis> Multiple Authentication Headers </span> </a> </li> <li class=md-nav__item> <a href=../../using/tool-annotations/ class=md-nav__link> <span class=md-ellipsis> Tool Annotations </span> </a> </li> <li class=md-nav__item> <a href=../../using/rest-passthrough/ class=md-nav__link> <span class=md-ellipsis> REST Passthrough Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../using/grpc-services/ class=md-nav__link> <span class=md-ellipsis> gRPC Services (Experimental) </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_9> <div class="md-nav__link md-nav__container"> <a href=../../using/clients/ class="md-nav__link "> <span class=md-ellipsis> Clients </span> </a> <label class="md-nav__link " for=__nav_3_9 id=__nav_3_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_9_label aria-expanded=false> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Clients </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/clients/mcp-inspector/ class=md-nav__link> <span class=md-ellipsis> MCP Inspector </span> </a> </li> <li class=md-nav__item> <a href=../../using/clients/claude-desktop/ class=md-nav__link> <span class=md-ellipsis> Claude Desktop × MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/clients/copilot/ class=md-nav__link> <span class=md-ellipsis> 🧠 GitHub Copilot + MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/clients/cline/ class=md-nav__link> <span class=md-ellipsis> Cline (VS Code Extension) </span> </a> </li> <li class=md-nav__item> <a href=../../using/clients/continue/ class=md-nav__link> <span class=md-ellipsis> Continue (VS Code Extension) </span> </a> </li> <li class=md-nav__item> <a href=../../using/clients/openwebui/ class=md-nav__link> <span class=md-ellipsis> OpenWebUI Integration with MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/clients/mcp-cli/ class=md-nav__link> <span class=md-ellipsis> 🖥️ MCP CLI + MCP Context Forge Gateway </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_10> <div class="md-nav__link md-nav__container"> <a href=../../using/agents/ class="md-nav__link "> <span class=md-ellipsis> Agents </span> </a> <label class="md-nav__link " for=__nav_3_10 id=__nav_3_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_10_label aria-expanded=false> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/agents/a2a/ class=md-nav__link> <span class=md-ellipsis> A2A (Agent-to-Agent) Integration </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/langchain/ class=md-nav__link> <span class=md-ellipsis> LangChain Integration with MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/langgraph/ class=md-nav__link> <span class=md-ellipsis> LangGraph Integration with MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/crewai/ class=md-nav__link> <span class=md-ellipsis> CrewAI Integration with MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/bee/ class=md-nav__link> <span class=md-ellipsis> Bee Agent Framework Integration with MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/autogen/ class=md-nav__link> <span class=md-ellipsis> AutoGen Integration with MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/semantic-kernel/ class=md-nav__link> <span class=md-ellipsis> Semantic Kernel Integration with MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/openai-sdk/ class=md-nav__link> <span class=md-ellipsis> OpenAI Agents SDK + MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../using/agents/llamaindex/ class=md-nav__link> <span class=md-ellipsis> LlamaIndex Integration with MCP Gateway </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11> <div class="md-nav__link md-nav__container"> <a href=../../using/servers/ class="md-nav__link "> <span class=md-ellipsis> MCP Servers </span> </a> <label class="md-nav__link " for=__nav_3_11 id=__nav_3_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_11_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11> <span class="md-nav__icon md-icon"></span> MCP Servers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_2> <label class=md-nav__link for=__nav_3_11_2 id=__nav_3_11_2_label tabindex=0> <span class=md-ellipsis> Go Servers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_11_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_2> <span class="md-nav__icon md-icon"></span> Go Servers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/servers/go/calculator-server/ class=md-nav__link> <span class=md-ellipsis> Go Calculator Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/go/fast-time-server/ class=md-nav__link> <span class=md-ellipsis> Go Fast Time Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/go/pandoc-server/ class=md-nav__link> <span class=md-ellipsis> Pandoc Server </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_3> <label class=md-nav__link for=__nav_3_11_3 id=__nav_3_11_3_label tabindex=0> <span class=md-ellipsis> Python Servers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_11_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_3> <span class="md-nav__icon md-icon"></span> Python Servers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/servers/python/chunker-server/ class=md-nav__link> <span class=md-ellipsis> Chunker Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/code-splitter-server/ class=md-nav__link> <span class=md-ellipsis> Code Splitter Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/csv-pandas-chat-server/ class=md-nav__link> <span class=md-ellipsis> CSV Pandas Chat Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/data-analysis-server/ class=md-nav__link> <span class=md-ellipsis> Python Data Analysis Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/docx-server/ class=md-nav__link> <span class=md-ellipsis> DOCX Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/eval-server/ class=md-nav__link> <span class=md-ellipsis> Python MCP Evaluation Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/graphviz-server/ class=md-nav__link> <span class=md-ellipsis> Graphviz Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/latex-server/ class=md-nav__link> <span class=md-ellipsis> LaTeX Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/libreoffice-server/ class=md-nav__link> <span class=md-ellipsis> LibreOffice Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/mermaid-server/ class=md-nav__link> <span class=md-ellipsis> Mermaid Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/plotly-server/ class=md-nav__link> <span class=md-ellipsis> Plotly Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/pptx-server/ class=md-nav__link> <span class=md-ellipsis> Python PowerPoint (PPTX) Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/python-sandbox-server/ class=md-nav__link> <span class=md-ellipsis> Python Sandbox Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/url-to-markdown-server/ class=md-nav__link> <span class=md-ellipsis> URL to Markdown Server </span> </a> </li> <li class=md-nav__item> <a href=../../using/servers/python/xlsx-server/ class=md-nav__link> <span class=md-ellipsis> XLSX Server </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_4> <label class=md-nav__link for=__nav_3_11_4 id=__nav_3_11_4_label tabindex=0> <span class=md-ellipsis> External Servers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_11_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_4> <span class="md-nav__icon md-icon"></span> External Servers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_4_1> <label class=md-nav__link for=__nav_3_11_4_1 id=__nav_3_11_4_1_label tabindex=0> <span class=md-ellipsis> GitHub Copilot </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_11_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_4_1> <span class="md-nav__icon md-icon"></span> GitHub Copilot </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/servers/external/microsoft/github/ class=md-nav__link> <span class=md-ellipsis> GitHub MCP Server </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_4_2> <label class=md-nav__link for=__nav_3_11_4_2 id=__nav_3_11_4_2_label tabindex=0> <span class=md-ellipsis> Box </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_11_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_4_2> <span class="md-nav__icon md-icon"></span> Box </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/servers/external/box/box/ class=md-nav__link> <span class=md-ellipsis> Box MCP Server </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_4_3> <div class="md-nav__link md-nav__container"> <a href=../../using/servers/external/open/ class="md-nav__link "> <span class=md-ellipsis> Open Servers </span> </a> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_11_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_4_3> <span class="md-nav__icon md-icon"></span> Open Servers </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_5> <label class=md-nav__link for=__nav_3_11_5 id=__nav_3_11_5_label tabindex=0> <span class=md-ellipsis> IBM Servers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_11_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_5> <span class="md-nav__icon md-icon"></span> IBM Servers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/servers/ibm/instana/ class=md-nav__link> <span class=md-ellipsis> IBM Instana MCP Server </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_11_6> <label class=md-nav__link for=__nav_3_11_6 id=__nav_3_11_6_label tabindex=0> <span class=md-ellipsis> Hashicorp Servers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_11_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_11_6> <span class="md-nav__icon md-icon"></span> Hashicorp Servers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/servers/hashicorp/terraform/ class=md-nav__link> <span class=md-ellipsis> Terraform MCP Server </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_12> <div class="md-nav__link md-nav__container"> <a href=../../using/plugins/ class="md-nav__link "> <span class=md-ellipsis> Plugins </span> </a> <label class="md-nav__link " for=__nav_3_12 id=__nav_3_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_12_label aria-expanded=false> <label class=md-nav__title for=__nav_3_12> <span class="md-nav__icon md-icon"></span> Plugins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../using/plugins/lifecycle/ class=md-nav__link> <span class=md-ellipsis> Plugin Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=../../using/plugins/plugins/ class=md-nav__link> <span class=md-ellipsis> Available Plugins </span> </a> </li> <li class=md-nav__item> <a href=../../using/plugins/mtls/ class=md-nav__link> <span class=md-ellipsis> External Plugin mTLS Setup Guide </span> </a> </li> <li class=md-nav__item> <a href=../../using/plugins/rust-plugins/ class=md-nav__link> <span class=md-ellipsis> Rust Plugins - High-Performance Native Extensions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../deployment/ class="md-nav__link "> <span class=md-ellipsis> 🚀 Deploy </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 🚀 Deploy </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../deployment/local/ class=md-nav__link> <span class=md-ellipsis> 🐍 Local Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/container/ class=md-nav__link> <span class=md-ellipsis> 📦 Container Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/compose/ class=md-nav__link> <span class=md-ellipsis> 🧩 Docker Compose </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/kubernetes/ class=md-nav__link> <span class=md-ellipsis> ☸️ Kubernetes / OpenShift Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/openshift/ class=md-nav__link> <span class=md-ellipsis> ✨ Red Hat OpenShift </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/minikube/ class=md-nav__link> <span class=md-ellipsis> ⚡️ Minikube </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/helm/ class=md-nav__link> <span class=md-ellipsis> 🚀 Deploying the MCP Gateway Stack with Helm </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/argocd/ class=md-nav__link> <span class=md-ellipsis> 🚢 Deploying the MCP Gateway Stack with Argo CD </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/google-cloud-run/ class=md-nav__link> <span class=md-ellipsis> ☁️ Deploying MCP Gateway on Google Cloud Run </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/ibm-code-engine/ class=md-nav__link> <span class=md-ellipsis> ⚙️ IBM Code Engine </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/aws/ class=md-nav__link> <span class=md-ellipsis> 🟧 AWS </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/azure/ class=md-nav__link> <span class=md-ellipsis> 🔷 Azure </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/fly-io/ class=md-nav__link> <span class=md-ellipsis> ⚙️ Fly.io Deployment Guide for MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../deployment/proxy-auth/ class=md-nav__link> <span class=md-ellipsis> Proxy Authentication </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../manage/ class="md-nav__link "> <span class=md-ellipsis> 🛡️ Manage </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 🛡️ Manage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../manage/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration Reference </span> </a> </li> <li class=md-nav__item> <a href=../../manage/scale/ class=md-nav__link> <span class=md-ellipsis> Scaling MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../manage/tuning/ class=md-nav__link> <span class=md-ellipsis> Gateway Tuning Guide </span> </a> </li> <li class=md-nav__item> <a href=../../manage/backup/ class=md-nav__link> <span class=md-ellipsis> Backups </span> </a> </li> <li class=md-nav__item> <a href=../../manage/catalog/ class=md-nav__link> <span class=md-ellipsis> MCP Server Catalog </span> </a> </li> <li class=md-nav__item> <a href=../../manage/bulk-import/ class=md-nav__link> <span class=md-ellipsis> Bulk Import Tools </span> </a> </li> <li class=md-nav__item> <a href=../../manage/metadata-tracking/ class=md-nav__link> <span class=md-ellipsis> 📊 Metadata Tracking &amp; Audit Trails </span> </a> </li> <li class=md-nav__item> <a href=../../manage/export-import/ class=md-nav__link> <span class=md-ellipsis> Configuration Export &amp; Import </span> </a> </li> <li class=md-nav__item> <a href=../../manage/export-import-tutorial/ class=md-nav__link> <span class=md-ellipsis> Export/Import Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/export-import-reference/ class=md-nav__link> <span class=md-ellipsis> Export/Import Quick Reference </span> </a> </li> <li class=md-nav__item> <a href=../../manage/logging/ class=md-nav__link> <span class=md-ellipsis> Logging </span> </a> </li> <li class=md-nav__item> <a href=../../manage/logging-examples/ class=md-nav__link> <span class=md-ellipsis> Logging Examples for MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../manage/observability/ class=md-nav__link> <span class=md-ellipsis> Observability </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_15> <label class=md-nav__link for=__nav_5_15 id=__nav_5_15_label tabindex=0> <span class=md-ellipsis> Observability </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_15_label aria-expanded=false> <label class=md-nav__title for=__nav_5_15> <span class="md-nav__icon md-icon"></span> Observability </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../manage/observability/observability/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../manage/observability/phoenix/ class=md-nav__link> <span class=md-ellipsis> Phoenix Integration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../manage/proxy/ class=md-nav__link> <span class=md-ellipsis> Proxy Authentication </span> </a> </li> <li class=md-nav__item> <a href=../../manage/dcr/ class=md-nav__link> <span class=md-ellipsis> Dynamic Client Registration (DCR) </span> </a> </li> <li class=md-nav__item> <a href=../../manage/oauth/ class=md-nav__link> <span class=md-ellipsis> OAuth 2.0 Integration </span> </a> </li> <li class=md-nav__item> <a href=../../manage/securing/ class=md-nav__link> <span class=md-ellipsis> Securing MCP Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso/ class=md-nav__link> <span class=md-ellipsis> Single Sign-On (SSO) Authentication </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso-github-tutorial/ class=md-nav__link> <span class=md-ellipsis> GitHub SSO Setup Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso-google-tutorial/ class=md-nav__link> <span class=md-ellipsis> Google OAuth/OIDC Setup Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso-ibm-tutorial/ class=md-nav__link> <span class=md-ellipsis> IBM Security Verify Setup Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso-microsoft-entra-id-tutorial/ class=md-nav__link> <span class=md-ellipsis> Microsoft Entra ID OIDC Setup Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso-keycloak-tutorial/ class=md-nav__link> <span class=md-ellipsis> Keycloak OIDC Setup Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso-okta-tutorial/ class=md-nav__link> <span class=md-ellipsis> Okta OIDC Setup Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/sso-generic-oidc-tutorial/ class=md-nav__link> <span class=md-ellipsis> Generic OIDC Provider Setup Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../../manage/rbac/ class=md-nav__link> <span class=md-ellipsis> RBAC Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../manage/teams/ class=md-nav__link> <span class=md-ellipsis> Team Management </span> </a> </li> <li class=md-nav__item> <a href=../../manage/ui-customization/ class=md-nav__link> <span class=md-ellipsis> Customizing the Admin UI </span> </a> </li> <li class=md-nav__item> <a href=../../manage/upgrade/ class=md-nav__link> <span class=md-ellipsis> Upgrading MCP Gateway and Managing Database Migrations </span> </a> </li> <li class=md-nav__item> <a href=../../manage/well-known-uris/ class=md-nav__link> <span class=md-ellipsis> Well-Known URI Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../development/ class="md-nav__link "> <span class=md-ellipsis> 💻 Develop </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 💻 Develop </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/developer-onboarding/ class=md-nav__link> <span class=md-ellipsis> ✅ Developer Onboarding Checklist </span> </a> </li> <li class=md-nav__item> <a href=../../development/mcp-developer-guide-json-rpc/ class=md-nav__link> <span class=md-ellipsis> MCP JSON RPC Guide </span> </a> </li> <li class=md-nav__item> <a href=../../development/github/ class=md-nav__link> <span class=md-ellipsis> GitHub Workflow Guide </span> </a> </li> <li class=md-nav__item> <a href=../../development/building/ class=md-nav__link> <span class=md-ellipsis> Building Locally </span> </a> </li> <li class=md-nav__item> <a href=../../development/documentation/ class=md-nav__link> <span class=md-ellipsis> Writing &amp; Publishing Documentation </span> </a> </li> <li class=md-nav__item> <a href=../../development/review/ class=md-nav__link> <span class=md-ellipsis> Reviewing a Pull Request </span> </a> </li> <li class=md-nav__item> <a href=../../development/packaging/ class=md-nav__link> <span class=md-ellipsis> Packaging &amp; Distribution </span> </a> </li> <li class=md-nav__item> <a href=../../development/developer-workstation/ class=md-nav__link> <span class=md-ellipsis> Developer Workstation </span> </a> </li> <li class=md-nav__item> <a href=../../development/doctest-coverage/ class=md-nav__link> <span class=md-ellipsis> Doctest Coverage </span> </a> </li> <li class=md-nav__item> <a href=../../development/module-documentation/ class=md-nav__link> <span class=md-ellipsis> Module documentation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../../testing/ class="md-nav__link "> <span class=md-ellipsis> 🧪 Test </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> 🧪 Test </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../testing/basic/ class=md-nav__link> <span class=md-ellipsis> MCP Gateway - Basic </span> </a> </li> <li class=md-nav__item> <a href=../../testing/performance/ class=md-nav__link> <span class=md-ellipsis> Performance Testing </span> </a> </li> <li class=md-nav__item> <a href=../../testing/acceptance/ class=md-nav__link> <span class=md-ellipsis> MCP Gateway Manual Acceptance Testing </span> </a> </li> <li class=md-nav__item> <a href=../../testing/fuzzing/ class=md-nav__link> <span class=md-ellipsis> Fuzz Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> 📐 Design &amp; Roadmap </span> </a> <label class="md-nav__link " for=__nav_8 id=__nav_8_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=true> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> 📐 Design &amp; Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../roadmap/ class=md-nav__link> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../security-features/ class=md-nav__link> <span class=md-ellipsis> Security Features </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Plugin Framework </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Plugin Framework </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> <nav class=md-nav aria-label=Overview> <ul class=md-nav__list> <li class=md-nav__item> <a href=#design-principles class=md-nav__link> <span class=md-ellipsis> Design Principles </span> </a> </li> <li class=md-nav__item> <a href=#terminology class=md-nav__link> <span class=md-ellipsis> Terminology </span> </a> </li> <li class=md-nav__item> <a href=#features class=md-nav__link> <span class=md-ellipsis> Features </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#architecture class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> <nav class=md-nav aria-label=Architecture> <ul class=md-nav__list> <li class=md-nav__item> <a href=#component-view class=md-nav__link> <span class=md-ellipsis> Component View </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#plugin-types-and-configuration class=md-nav__link> <span class=md-ellipsis> Plugin Types and Configuration </span> </a> <nav class=md-nav aria-label="Plugin Types and Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#plugin-deployment-patterns class=md-nav__link> <span class=md-ellipsis> Plugin Deployment Patterns </span> </a> </li> <li class=md-nav__item> <a href=#plugin-configuration-schema class=md-nav__link> <span class=md-ellipsis> Plugin Configuration Schema </span> </a> </li> <li class=md-nav__item> <a href=#plugin-manifest class=md-nav__link> <span class=md-ellipsis> Plugin Manifest </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#core-components class=md-nav__link> <span class=md-ellipsis> Core Components </span> </a> <nav class=md-nav aria-label="Core Components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#core-framework-structure class=md-nav__link> <span class=md-ellipsis> Core Framework Structure </span> </a> </li> <li class=md-nav__item> <a href=#base-plugin-class class=md-nav__link> <span class=md-ellipsis> Base Plugin Class </span> </a> </li> <li class=md-nav__item> <a href=#plugin-manager class=md-nav__link> <span class=md-ellipsis> Plugin Manager </span> </a> </li> <li class=md-nav__item> <a href=#plugin-registry class=md-nav__link> <span class=md-ellipsis> Plugin Registry </span> </a> </li> <li class=md-nav__item> <a href=#plugin-reference-system class=md-nav__link> <span class=md-ellipsis> Plugin Reference System </span> </a> </li> <li class=md-nav__item> <a href=#configuration-loading class=md-nav__link> <span class=md-ellipsis> Configuration Loading </span> </a> </li> <li class=md-nav__item> <a href=#plugin-configuration-models class=md-nav__link> <span class=md-ellipsis> Plugin Configuration Models </span> </a> </li> <li class=md-nav__item> <a href=#context-management class=md-nav__link> <span class=md-ellipsis> Context Management </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hook-system class=md-nav__link> <span class=md-ellipsis> Hook System </span> </a> <nav class=md-nav aria-label="Hook System"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hook-execution-flow class=md-nav__link> <span class=md-ellipsis> Hook Execution Flow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hook-reference-documentation class=md-nav__link> <span class=md-ellipsis> Hook Reference Documentation </span> </a> <nav class=md-nav aria-label="Hook Reference Documentation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mcp-security-hooks class=md-nav__link> <span class=md-ellipsis> MCP Security Hooks </span> </a> </li> <li class=md-nav__item> <a href=#gateway-administrative-hooks class=md-nav__link> <span class=md-ellipsis> Gateway Administrative Hooks </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#external-plugin-integration class=md-nav__link> <span class=md-ellipsis> External Plugin Integration </span> </a> <nav class=md-nav aria-label="External Plugin Integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#plugin-lifecycle class=md-nav__link> <span class=md-ellipsis> Plugin Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=#mcp-protocol-integration class=md-nav__link> <span class=md-ellipsis> MCP Protocol Integration </span> </a> </li> <li class=md-nav__item> <a href=#required-mcp-tools class=md-nav__link> <span class=md-ellipsis> Required MCP Tools </span> </a> </li> <li class=md-nav__item> <a href=#external-plugin-configuration class=md-nav__link> <span class=md-ellipsis> External Plugin Configuration </span> </a> </li> <li class=md-nav__item> <a href=#external-plugin-example-typescript class=md-nav__link> <span class=md-ellipsis> External Plugin Example (TypeScript) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#security-and-protection class=md-nav__link> <span class=md-ellipsis> Security and Protection </span> </a> <nav class=md-nav aria-label="Security and Protection"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#timeout-protection class=md-nav__link> <span class=md-ellipsis> Timeout Protection </span> </a> </li> <li class=md-nav__item> <a href=#payload-size-validation class=md-nav__link> <span class=md-ellipsis> Payload Size Validation </span> </a> </li> <li class=md-nav__item> <a href=#error-isolation class=md-nav__link> <span class=md-ellipsis> Error Isolation </span> </a> </li> <li class=md-nav__item> <a href=#security-capabilities class=md-nav__link> <span class=md-ellipsis> Security Capabilities </span> </a> </li> <li class=md-nav__item> <a href=#plugin-signing class=md-nav__link> <span class=md-ellipsis> Plugin Signing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance-considerations class=md-nav__link> <span class=md-ellipsis> Performance Considerations </span> </a> <nav class=md-nav aria-label="Performance Considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#resource-management class=md-nav__link> <span class=md-ellipsis> Resource Management </span> </a> </li> <li class=md-nav__item> <a href=#optimization-strategies class=md-nav__link> <span class=md-ellipsis> Optimization Strategies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#development-guidelines class=md-nav__link> <span class=md-ellipsis> Development Guidelines </span> </a> <nav class=md-nav aria-label="Development Guidelines"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#plugin-development-workflow class=md-nav__link> <span class=md-ellipsis> Plugin Development Workflow </span> </a> </li> <li class=md-nav__item> <a href=#built-in-plugin-examples class=md-nav__link> <span class=md-ellipsis> Built-in Plugin Examples </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> <nav class=md-nav aria-label=Testing> <ul class=md-nav__list> <li class=md-nav__item> <a href=#testing-framework-integration class=md-nav__link> <span class=md-ellipsis> Testing Framework Integration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#platform-agnostic-design class=md-nav__link> <span class=md-ellipsis> Platform-Agnostic Design </span> </a> <nav class=md-nav aria-label="Platform-Agnostic Design"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#framework-portability class=md-nav__link> <span class=md-ellipsis> Framework Portability </span> </a> </li> <li class=md-nav__item> <a href=#integration-patterns class=md-nav__link> <span class=md-ellipsis> Integration Patterns </span> </a> </li> <li class=md-nav__item> <a href=#language-interoperability class=md-nav__link> <span class=md-ellipsis> Language Interoperability </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#future-extensions class=md-nav__link> <span class=md-ellipsis> Future Extensions </span> </a> <nav class=md-nav aria-label="Future Extensions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#planned-hook-points class=md-nav__link> <span class=md-ellipsis> Planned Hook Points </span> </a> </li> <li class=md-nav__item> <a href=#external-service-integrations class=md-nav__link> <span class=md-ellipsis> External Service Integrations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../export-import-architecture/ class=md-nav__link> <span class=md-ellipsis> Export-Import Architecture </span> </a> </li> <li class=md-nav__item> <a href=../multitenancy/ class=md-nav__link> <span class=md-ellipsis> Multitenancy </span> </a> </li> <li class=md-nav__item> <a href=../oauth-design/ class=md-nav__link> <span class=md-ellipsis> OAuth </span> </a> </li> <li class=md-nav__item> <a href=../oauth-authorization-code-ui-design/ class=md-nav__link> <span class=md-ellipsis> OAuth UI </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_9> <div class="md-nav__link md-nav__container"> <a href=../adr/ class="md-nav__link "> <span class=md-ellipsis> Decision Records </span> </a> <label class="md-nav__link " for=__nav_8_9 id=__nav_8_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_9_label aria-expanded=false> <label class=md-nav__title for=__nav_8_9> <span class="md-nav__icon md-icon"></span> Decision Records </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../adr/001-adopt-fastapi-pydantic/ class=md-nav__link> <span class=md-ellipsis> 1 Adopt FastAPI + Pydantic </span> </a> </li> <li class=md-nav__item> <a href=../adr/002-use-async-sqlalchemy-orm/ class=md-nav__link> <span class=md-ellipsis> 2 Use Async SQLAlchemy ORM </span> </a> </li> <li class=md-nav__item> <a href=../adr/003-expose-multi-transport-endpoints/ class=md-nav__link> <span class=md-ellipsis> 3 Expose Multi-Transport Endpoints </span> </a> </li> <li class=md-nav__item> <a href=../adr/004-combine-jwt-and-basic-auth/ class=md-nav__link> <span class=md-ellipsis> 4 Combine JWT &amp; Basic Auth </span> </a> </li> <li class=md-nav__item> <a href=../adr/005-structured-json-logging/ class=md-nav__link> <span class=md-ellipsis> 5 Structured JSON Logging </span> </a> </li> <li class=md-nav__item> <a href=../adr/006-gateway-tool-rate-limiting/ class=md-nav__link> <span class=md-ellipsis> 6 Gateway &amp; Tool-Level Rate Limiting </span> </a> </li> <li class=md-nav__item> <a href=../adr/007-pluggable-cache-backend/ class=md-nav__link> <span class=md-ellipsis> 7 Pluggable Cache Backend </span> </a> </li> <li class=md-nav__item> <a href=../adr/008-federation-discovery/ class=md-nav__link> <span class=md-ellipsis> 8 Federation &amp; Auto-Discovery via DNS-SD </span> </a> </li> <li class=md-nav__item> <a href=../adr/009-built-in-health-checks/ class=md-nav__link> <span class=md-ellipsis> 9 Built-in Health Checks </span> </a> </li> <li class=md-nav__item> <a href=../adr/010-observability-prometheus/ class=md-nav__link> <span class=md-ellipsis> 10 Observability via Prometheus </span> </a> </li> <li class=md-nav__item> <a href=../adr/011-tool-federation/ class=md-nav__link> <span class=md-ellipsis> 11 Namespaced Tool Federation </span> </a> </li> <li class=md-nav__item> <a href=../adr/012-dropdown-ui-tool-selection/ class=md-nav__link> <span class=md-ellipsis> 12 Drop-down tool selection </span> </a> </li> <li class=md-nav__item> <a href=../adr/013-APIs-for-server-connection-strings/ class=md-nav__link> <span class=md-ellipsis> 13 APIs for server connection string </span> </a> </li> <li class=md-nav__item> <a href=../adr/014-security-headers-cors-middleware/ class=md-nav__link> <span class=md-ellipsis> 14 Security Headers &amp; CORS Middleware </span> </a> </li> <li class=md-nav__item> <a href=../adr/015-well-known-uri-handler/ class=md-nav__link> <span class=md-ellipsis> 15 Well-known URI Handler </span> </a> </li> <li class=md-nav__item> <a href=../adr/016-plugin-framework-ai-middleware/ class=md-nav__link> <span class=md-ellipsis> 16 Plugin Framework &amp; AI Middleware </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <div class="md-nav__link md-nav__container"> <a href=../../media/ class="md-nav__link "> <span class=md-ellipsis> 📰 Media </span> </a> <label class="md-nav__link " for=__nav_9 id=__nav_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> 📰 Media </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_2> <div class="md-nav__link md-nav__container"> <a href=../../media/kit/ class="md-nav__link "> <span class=md-ellipsis> Media Kit </span> </a> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_2_label aria-expanded=false> <label class=md-nav__title for=__nav_9_2> <span class="md-nav__icon md-icon"></span> Media Kit </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_3> <div class="md-nav__link md-nav__container"> <a href=../../media/press/ class="md-nav__link "> <span class=md-ellipsis> Press </span> </a> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_3_label aria-expanded=false> <label class=md-nav__title for=__nav_9_3> <span class="md-nav__icon md-icon"></span> Press </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_4> <div class="md-nav__link md-nav__container"> <a href=../../media/social/ class="md-nav__link "> <span class=md-ellipsis> Social </span> </a> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_4_label aria-expanded=false> <label class=md-nav__title for=__nav_9_4> <span class="md-nav__icon md-icon"></span> Social </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10> <div class="md-nav__link md-nav__container"> <a href=../../tutorials/ class="md-nav__link "> <span class=md-ellipsis> 📖 Tutorials </span> </a> <label class="md-nav__link " for=__nav_10 id=__nav_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> 📖 Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/argocd-helm-deployment-ibm-cloud-iks/ class=md-nav__link> <span class=md-ellipsis> 🚀 Deploying the MCP Gateway Stack to IBM Cloud Kubernetes Service with Argo CD </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/openwebui-tutorial/ class=md-nav__link> <span class=md-ellipsis> OpenWebUI with Ollama, LiteLLM, MCPO, and MCP Gateway Deployment Guide </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/dcr-hyprmcp/ class=md-nav__link> <span class=md-ellipsis> Dynamic Client Registration with HyprMCP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> ⭐ Best Practices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> ⭐ Best Practices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../best-practices/mcp-best-practices/ class=md-nav__link> <span class=md-ellipsis> ⭐ Best Practices Guide </span> </a> </li> <li class=md-nav__item> <a href=../../best-practices/developing-your-mcp-server-python/ class=md-nav__link> <span class=md-ellipsis> 🛠️ Write an MCP Server in Python </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_12> <div class="md-nav__link md-nav__container"> <a href=../../faq/ class="md-nav__link "> <span class=md-ellipsis> ❓ FAQ </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> ❓ FAQ </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/ibm/mcp-context-forge/edit/main/docs/docs/architecture/plugins.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.06 9 .94.94L5.92 19H5v-.92zm3.6-6c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"></path></svg> </a> <h1 id=plugin-framework-specification>Plugin Framework Specification<a class=headerlink href=#plugin-framework-specification title="Permanent link">¶</a></h1> <p><strong>Version</strong>: 1.0 <strong>Status</strong>: Draft</p> <p>The MCP Context Forge Plugin Framework provides a comprehensive, production-ready system for extending MCP Gateway functionality through pluggable middleware components. These plugins interpose calls to MCP and agentic components to apply security, AI, business logic, and monitoring capabilities to existing flows. This specification defines the architecture, interfaces, and protocols for developing, deploying, and managing plugins within the MCP ecosystem.</p> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">¶</a></h2> <ol> <li><a href=#overview>Overview</a></li> <li><a href=#architecture>Architecture</a></li> <li><a href=#plugin-types-and-configuration>Plugin Types and Configuration</a></li> <li><a href=#core-components>Core Components</a></li> <li><a href=#hook-system>Hook System</a></li> <li><a href=#hook-reference-documentation>Hook Reference Documentation</a></li> <li><a href=#external-plugin-integration>External Plugin Integration</a></li> <li><a href=#security-and-protection>Security and Protection</a></li> <li><a href=#performance-considerations>Performance Considerations</a></li> <li><a href=#development-guidelines>Development Guidelines</a></li> <li><a href=#testing>Testing</a></li> <li><a href=#platform-agnostic-design>Platform-Agnostic Design</a></li> <li><a href=#future-extensions>Future Extensions</a></li> </ol> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">¶</a></h2> <p>The plugin framework is designed as a <strong>standalone, platform-agnostic ecosystem</strong> that can be embedded in any application requiring extensible middleware processing. It enables both <strong>native plugins</strong> (running in-process) and <strong>external plugin integrations</strong> (remote MCP servers) through a unified interface. This approach balances performance, security, and operational requirements while providing maximum flexibility for deployment across different environments and platforms.</p> <h3 id=design-principles>Design Principles<a class=headerlink href=#design-principles title="Permanent link">¶</a></h3> <ol> <li><strong>Platform Agnostic</strong>: The Framework is implemented in Python, but external plugins can be implemented in any language of choice.</li> <li><strong>Protocol Neutral</strong>: Supports multiple transport mechanisms (Streamable HTTP (JSON-RPC), STDIO, SSE), and can be extended to support additional protocols</li> <li><strong>MCP Native</strong>: Remote plugins are fully compliant MCP servers</li> <li><strong>Security First</strong>: Comprehensive protection, validation, and isolation</li> <li><strong>Production Ready</strong>: Built for high-throughput, low-latency environments</li> <li><strong>Developer Friendly</strong>: Simple APIs with comprehensive tooling</li> </ol> <h3 id=terminology>Terminology<a class=headerlink href=#terminology title="Permanent link">¶</a></h3> <ul> <li><strong>Plugin</strong>: A middleware component that processes MCP requests/responses</li> <li><strong>Hook</strong>: A specific point in the MCP lifecycle where plugins execute</li> <li><strong>Native Plugin</strong>: Plugin running in-process with the gateway</li> <li><strong>External Plugin</strong>: Plugin running as a remote MCP server</li> <li><strong>Plugin Manager</strong>: Core service managing plugin lifecycle and execution</li> <li><strong>Plugin Context</strong>: Request-scoped state shared between plugins</li> <li><strong>Plugin Configuration</strong>: YAML-based plugin setup and parameters</li> </ul> <h3 id=features>Features<a class=headerlink href=#features title="Permanent link">¶</a></h3> <p>Legend: ✅ = Completed | 🚧 = In Progress | 📋 = Planned</p> <p><strong>Plugin Lifecycle Management</strong></p> <ul> <li>✅ <strong>Discovery &amp; Loading</strong>: Automatically discover and load plugins from configuration</li> <li>📋 <strong>Dependency Resolution</strong>: Handle plugin dependencies and load order</li> <li>✅ <strong>Runtime Control</strong>: Enable, disable, or modify plugin behavior without code changes</li> <li>✅ <strong>Version Management</strong>: Track plugin versions and manage updates</li> </ul> <p><strong>Operational Control</strong></p> <ul> <li>🚧 <strong>Environment-Specific Deployment</strong>: Different configurations for dev/staging/production</li> <li>✅ <strong>Conditional Execution</strong>: Run plugins only under specific conditions (tenant, server, user)</li> <li>✅ <strong>Priority-Based Orchestration</strong>: Control execution order through priority settings</li> <li>✅ <strong>Mode-Based Behavior</strong>: Switch between enforce/enforce_ignore_error/permissive/disabled modes</li> </ul> <p><strong>Security &amp; Compliance</strong></p> <ul> <li>✅ <strong>Conditional Execution</strong>: Restrict plugin execution to specific users, tools, or servers</li> <li>✅ <strong>Audit Trail</strong>: Track plugin configuration changes and deployment history</li> <li>✅ <strong>Policy Enforcement</strong>: Implement organizational security policies through configuration</li> <li>📋 <strong>External Service Integration</strong>: Securely configure connections to external AI safety services</li> </ul> <p><strong>Performance Optimization</strong></p> <ul> <li>✅ <strong>Resource Limits</strong>: Configure timeouts, memory limits, and execution constraints</li> <li>📋 <strong>Selective Loading</strong>: Load only necessary plugins to optimize performance</li> <li>✅ <strong>Monitoring Integration</strong>: Configure metrics collection and health monitoring</li> <li>📋 <strong>Caching Strategies</strong>: Control plugin result caching and optimization</li> </ul> <h2 id=architecture>Architecture<a class=headerlink href=#architecture title="Permanent link">¶</a></h2> <p>The plugin framework implements an execution pipeline designed for enterprise-grade performance, security, and reliability.</p> <h3 id=component-view>Component View<a class=headerlink href=#component-view title="Permanent link">¶</a></h3> <p>Below is a view of the core components of the plugin system, which extends the gateway request execution pipeline with pre- and post- protocol hooks implemented by plugins.</p> <pre class=mermaid><code>flowchart TB
    subgraph "MCP Client"
        Client["MCP Client Application"]
    end

    subgraph GW["MCP Gateway"]
        Gateway["Gateway Core"]
        PM["Plugin Manager"]
        Executor["Plugin Executor"]
    end

    subgraph "Plugin Ecosystem"
        Native["Native Plugins"]
        External["External MCP &lt;br&gt; Plugin Servers"]
    end

    subgraph "External Services"
        AI["AI Safety Services&lt;br&gt;(LlamaGuard, OpenAI)"]
        Security["Security Services&lt;br&gt;(Vault, OPA)"]
    end

    Client --request--&gt; GW
    GW --response--&gt; Client
    Gateway --&gt; PM
    PM --&gt; Executor
    Executor --&gt; Native
    Executor --&gt; External
    External --&gt; AI
    External --&gt; Security

    style Gateway fill:#e3f2fd
    style PM fill:#fff3e0
    style Native fill:#e8f5e8
    style External fill:#fff8e1</code></pre> <h2 id=plugin-types-and-configuration>Plugin Types and Configuration<a class=headerlink href=#plugin-types-and-configuration title="Permanent link">¶</a></h2> <p>The plugin configuration system provides a declarative, YAML-based approach to plugin management, deployment, and orchestration.</p> <p>The configuration system supports both <strong>native plugins</strong> (running in-process) and <strong>external plugins</strong> (remote MCP servers), providing a unified interface for managing diverse plugin architectures while maintaining type safety, validation, and operational excellence.</p> <h3 id=plugin-deployment-patterns>Plugin Deployment Patterns<a class=headerlink href=#plugin-deployment-patterns title="Permanent link">¶</a></h3> <p>The framework supports two distinct plugin deployment patterns:</p> <h4 id=native-plugins-in-process><strong>Native Plugins</strong> (In-Process)<a class=headerlink href=#native-plugins-in-process title="Permanent link">¶</a></h4> <ul> <li>Execute within the main application process</li> <li>Written in Python and extend the base <code>Plugin</code> class</li> <li>Fastest execution with shared memory access</li> <li>Examples: regex filters, simple transforms, validation</li> </ul> <h4 id=external-plugins-remote-mcp-servers><strong>External Plugins</strong> (Remote MCP Servers)<a class=headerlink href=#external-plugins-remote-mcp-servers title="Permanent link">¶</a></h4> <ul> <li>Standalone MCP servers implementing plugin logic</li> <li>Can be written in any language (Python, TypeScript, Go, Rust, etc.)</li> <li>Communicate via MCP protocol (Streamable HTTP, STDIO, SSE)</li> <li>Examples: OPA filter, LlamaGuard, OpenAI Moderation, custom AI services</li> </ul> <h3 id=plugin-configuration-schema>Plugin Configuration Schema<a class=headerlink href=#plugin-configuration-schema title="Permanent link">¶</a></h3> <p>Below is an example of a plugin configuration file. A plugin configuration file can configure one or more plugins in a prioritized list as below. Each individual plugin is an instance of the of a plugin class that subclasses the base <code>Plugin</code> object and implements a set of hooks as listed in the configuration.</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># plugins/config.yaml</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=nt>plugins</span><span class=p>:</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"PIIFilterPlugin"</span><span class=w>                    </span><span class=c1># Unique plugin identifier</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"plugins.pii_filter.pii_filter.PIIFilterPlugin"</span><span class=w>  </span><span class=c1># Plugin class path</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>"Detects</span><span class=nv> </span><span class=s>and</span><span class=nv> </span><span class=s>masks</span><span class=nv> </span><span class=s>PII"</span><span class=w>       </span><span class=c1># Human-readable description</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s>"1.0.0"</span><span class=w>                          </span><span class=c1># Plugin version</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>    </span><span class=nt>author</span><span class=p>:</span><span class=w> </span><span class=s>"Security</span><span class=nv> </span><span class=s>Team"</span><span class=w>                   </span><span class=c1># Plugin author</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>    </span><span class=nt>hooks</span><span class=p>:</span><span class=w>                                    </span><span class=c1># Hook registration</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"prompt_pre_fetch"</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"tool_pre_invoke"</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"tool_post_invoke"</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=w>    </span><span class=nt>tags</span><span class=p>:</span><span class=w>                                     </span><span class=c1># Searchable tags</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"security"</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"pii"</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"compliance"</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=w>    </span><span class=nt>mode</span><span class=p>:</span><span class=w> </span><span class=s>"enforce"</span><span class=w>                           </span><span class=c1># enforce|enforce_ignore_error|permissive|disabled</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=w>    </span><span class=nt>priority</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">50</span><span class=w>                              </span><span class=c1># Execution priority (lower = higher)</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=w>    </span><span class=nt>conditions</span><span class=p>:</span><span class=w>                               </span><span class=c1># Conditional execution</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>server_ids</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>"prod-server"</span><span class="p p-Indicator">]</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=w>        </span><span class=nt>tenant_ids</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>"enterprise"</span><span class="p p-Indicator">]</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=w>        </span><span class=nt>tools</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>"sensitive-tool"</span><span class="p p-Indicator">]</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>                                   </span><span class=c1># Plugin-specific configuration</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>      </span><span class=nt>detect_ssn</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=w>      </span><span class=nt>detect_credit_card</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=w>      </span><span class=nt>mask_strategy</span><span class=p>:</span><span class=w> </span><span class=s>"partial"</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=w>      </span><span class=nt>redaction_text</span><span class=p>:</span><span class=w> </span><span class=s>"[REDACTED]"</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=c1># Global plugin settings</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=nt>plugin_settings</span><span class=p>:</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=w>  </span><span class=nt>parallel_execution_within_band</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>      </span><span class=c1># Execute same-priority plugins in parallel</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=w>  </span><span class=nt>plugin_timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class=w>                         </span><span class=c1># Per-plugin timeout (seconds)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=w>  </span><span class=nt>fail_on_plugin_error</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>                </span><span class=c1># Continue on plugin failures</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=w>  </span><span class=nt>plugin_health_check_interval</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class=w>           </span><span class=c1># Health check interval (seconds)</span>
</span></code></pre></div> <h4 id=plugin-configuration-attributes>Plugin Configuration Attributes<a class=headerlink href=#plugin-configuration-attributes title="Permanent link">¶</a></h4> <p>Details of each field are below:</p> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Required</th> <th>Default</th> <th>Description</th> <th>Example Values</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td><code>string</code></td> <td>Yes</td> <td>-</td> <td>Unique plugin identifier within the configuration</td> <td><code>"PIIFilterPlugin"</code>, <code>"OpenAIModeration"</code></td> </tr> <tr> <td><code>kind</code></td> <td><code>string</code></td> <td>Yes</td> <td>-</td> <td>Plugin class path for native plugins or <code>"external"</code> for MCP servers</td> <td><code>"plugins.pii_filter.pii_filter.PIIFilterPlugin"</code>, <code>"external"</code></td> </tr> <tr> <td><code>description</code></td> <td><code>string</code></td> <td></td> <td><code>null</code></td> <td>Human-readable description of plugin functionality</td> <td><code>"Detects and masks PII in requests"</code></td> </tr> <tr> <td><code>author</code></td> <td><code>string</code></td> <td></td> <td><code>null</code></td> <td>Plugin author or team responsible for maintenance</td> <td><code>"Security Team"</code>, <code>"AI Safety Group"</code></td> </tr> <tr> <td><code>version</code></td> <td><code>string</code></td> <td></td> <td><code>null</code></td> <td>Plugin version for tracking and compatibility</td> <td><code>"1.0.0"</code>, <code>"2.3.1-beta"</code></td> </tr> <tr> <td><code>hooks</code></td> <td><code>string[]</code></td> <td></td> <td><code>[]</code></td> <td>List of hook points where plugin executes</td> <td><code>["prompt_pre_fetch", "tool_pre_invoke"]</code></td> </tr> <tr> <td><code>tags</code></td> <td><code>string[]</code></td> <td></td> <td><code>[]</code></td> <td>Searchable tags for plugin categorization</td> <td><code>["security", "pii", "compliance"]</code></td> </tr> <tr> <td><code>mode</code></td> <td><code>string</code></td> <td></td> <td><code>"enforce"</code></td> <td>Plugin execution mode controlling behavior on violations</td> <td><code>"enforce"</code>, <code>"enforce_ignore_error"</code>, <code>"permissive"</code>, <code>"disabled"</code></td> </tr> <tr> <td><code>priority</code></td> <td><code>integer</code></td> <td></td> <td><code>null</code></td> <td>Execution priority (lower number = higher priority)</td> <td><code>10</code>, <code>50</code>, <code>100</code></td> </tr> <tr> <td><code>conditions</code></td> <td><code>object[]</code></td> <td></td> <td><code>[]</code></td> <td>Conditional execution rules for targeting specific contexts</td> <td>See <a href=#condition-fields>Condition Fields</a> below</td> </tr> <tr> <td><code>config</code></td> <td><code>object</code></td> <td></td> <td><code>{}</code></td> <td>Plugin-specific configuration parameters</td> <td><code>{"detect_ssn": true, "mask_strategy": "partial"}</code></td> </tr> <tr> <td><code>mcp</code></td> <td><code>object</code></td> <td></td> <td><code>null</code></td> <td>External MCP server configuration (required for external plugins)</td> <td>See <a href=#mcp-configuration-fields>MCP Configuration</a> below</td> </tr> </tbody> </table> <h4 id=hook-types>Hook Types<a class=headerlink href=#hook-types title="Permanent link">¶</a></h4> <p>Available hook values for the <code>hooks</code> field:</p> <table> <thead> <tr> <th>Hook Value</th> <th>Description</th> <th>Timing</th> </tr> </thead> <tbody> <tr> <td><code>"prompt_pre_fetch"</code></td> <td>Process prompt requests before template processing</td> <td>Before prompt template retrieval</td> </tr> <tr> <td><code>"prompt_post_fetch"</code></td> <td>Process prompt responses after template rendering</td> <td>After prompt template processing</td> </tr> <tr> <td><code>"tool_pre_invoke"</code></td> <td>Process tool calls before execution</td> <td>Before tool invocation</td> </tr> <tr> <td><code>"tool_post_invoke"</code></td> <td>Process tool results after execution</td> <td>After tool completion</td> </tr> <tr> <td><code>"resource_pre_fetch"</code></td> <td>Process resource requests before fetching</td> <td>Before resource retrieval</td> </tr> <tr> <td><code>"resource_post_fetch"</code></td> <td>Process resource content after loading</td> <td>After resource content loading</td> </tr> </tbody> </table> <h4 id=plugin-modes>Plugin Modes<a class=headerlink href=#plugin-modes title="Permanent link">¶</a></h4> <p>Available values for the <code>mode</code> field:</p> <table> <thead> <tr> <th>Mode</th> <th>Behavior</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><code>"enforce"</code></td> <td>Block requests when plugin detects violations or errors</td> <td>Production security plugins, critical compliance checks</td> </tr> <tr> <td><code>"enforce_ignore_error"</code></td> <td>Block on violations but continue on plugin errors</td> <td>Security plugins that should block violations but not break on technical errors</td> </tr> <tr> <td><code>"permissive"</code></td> <td>Log violations and errors but allow requests to continue</td> <td>Development environments, monitoring-only plugins</td> </tr> <tr> <td><code>"disabled"</code></td> <td>Plugin is loaded but never executed</td> <td>Temporary plugin deactivation, maintenance mode</td> </tr> </tbody> </table> <h4 id=condition-fields>Condition Fields<a class=headerlink href=#condition-fields title="Permanent link">¶</a></h4> <p>The <code>conditions</code> array contains objects that specify when plugins should execute:</p> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><code>server_ids</code></td> <td><code>string[]</code></td> <td>Execute only for specific virtual server IDs</td> <td><code>["prod-server", "api-gateway"]</code></td> </tr> <tr> <td><code>tenant_ids</code></td> <td><code>string[]</code></td> <td>Execute only for specific tenant/organization IDs</td> <td><code>["enterprise", "premium-tier"]</code></td> </tr> <tr> <td><code>tools</code></td> <td><code>string[]</code></td> <td>Execute only for specific tool names</td> <td><code>["file_reader", "web_scraper"]</code></td> </tr> <tr> <td><code>prompts</code></td> <td><code>string[]</code></td> <td>Execute only for specific prompt names</td> <td><code>["user_prompt", "system_message"]</code></td> </tr> <tr> <td><code>resources</code></td> <td><code>string[]</code></td> <td>Execute only for specific resource URI patterns</td> <td><code>["https://api.example.com/*"]</code></td> </tr> <tr> <td><code>user_patterns</code></td> <td><code>string[]</code></td> <td>Execute for users matching regex patterns</td> <td><code>["admin_.*", ".*@company.com"]</code></td> </tr> <tr> <td><code>content_types</code></td> <td><code>string[]</code></td> <td>Execute for specific content types</td> <td><code>["application/json", "text/plain"]</code></td> </tr> </tbody> </table> <h4 id=mcp-configuration-fields>MCP Configuration Fields<a class=headerlink href=#mcp-configuration-fields title="Permanent link">¶</a></h4> <p>For external plugins (<code>kind: "external"</code>), the <code>mcp</code> object configures the MCP server connection:</p> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Required</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><code>proto</code></td> <td><code>string</code></td> <td>Yes</td> <td>MCP transport protocol</td> <td><code>"stdio"</code>, <code>"sse"</code>, <code>"streamablehttp"</code>, <code>"websocket"</code></td> </tr> <tr> <td><code>url</code></td> <td><code>string</code></td> <td></td> <td>Service URL for HTTP-based transports</td> <td><code>"http://openai-plugin:3000/mcp"</code></td> </tr> <tr> <td><code>script</code></td> <td><code>string</code></td> <td></td> <td>Script path for STDIO transport</td> <td><code>"/opt/plugins/custom-filter.py"</code></td> </tr> </tbody> </table> <h4 id=global-plugin-settings>Global Plugin Settings<a class=headerlink href=#global-plugin-settings title="Permanent link">¶</a></h4> <p>The <code>plugin_settings</code> object controls framework-wide behavior:</p> <table> <thead> <tr> <th>Setting</th> <th>Type</th> <th>Default</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>parallel_execution_within_band</code></td> <td><code>boolean</code></td> <td><code>false</code></td> <td>Execute plugins with same priority in parallel</td> </tr> <tr> <td><code>plugin_timeout</code></td> <td><code>integer</code></td> <td><code>30</code></td> <td>Per-plugin timeout in seconds</td> </tr> <tr> <td><code>fail_on_plugin_error</code></td> <td><code>boolean</code></td> <td><code>false</code></td> <td>Stop processing on plugin errors</td> </tr> <tr> <td><code>plugin_health_check_interval</code></td> <td><code>integer</code></td> <td><code>60</code></td> <td>Health check interval in seconds</td> </tr> </tbody> </table> <h3 id=plugin-manifest>Plugin Manifest<a class=headerlink href=#plugin-manifest title="Permanent link">¶</a></h3> <p>The plugin manifest is a metadata file that provides structured information about a plugin's capabilities, dependencies, and characteristics. This manifest serves multiple purposes in the plugin ecosystem: development guidance, runtime validation, discoverability, and documentation.</p> <h4 id=manifest-purpose-and-usage>Manifest Purpose and Usage<a class=headerlink href=#manifest-purpose-and-usage title="Permanent link">¶</a></h4> <p>The plugin manifest (<code>plugin-manifest.yaml</code>) is primarily used by:</p> <ul> <li><strong>Plugin Templates</strong>: Bootstrap process uses manifest to generate plugin scaffolding</li> <li><strong>Plugin Catalog</strong>: Catalogs can provide enhanced search and organization based on manifest information</li> <li><strong>Plugin Discovery</strong>: Registry systems can index plugins based on manifest metadata</li> <li><strong>Documentation Generation</strong>: Automated documentation can be generated from manifest content</li> <li><strong>Dependency Management</strong>: Future versions may use manifest for dependency resolution</li> <li><strong>Security and Governance</strong>: Future versions may use manifest for specifying security capability requirements and storing signatures</li> </ul> <h4 id=manifest-structure>Manifest Structure<a class=headerlink href=#manifest-structure title="Permanent link">¶</a></h4> <p>The plugin manifest follows a structured YAML format that captures comprehensive plugin metadata:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># plugin-manifest.yaml</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"Advanced</span><span class=nv> </span><span class=s>PII</span><span class=nv> </span><span class=s>Filter"</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"plugins.pii_filter.pii_filter.PIIFilterPlugin"</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>"Comprehensive</span><span class=nv> </span><span class=s>PII</span><span class=nv> </span><span class=s>detection</span><span class=nv> </span><span class=s>and</span><span class=nv> </span><span class=s>masking</span><span class=nv> </span><span class=s>with</span><span class=nv> </span><span class=s>configurable</span><span class=nv> </span><span class=s>sensitivity</span><span class=nv> </span><span class=s>levels"</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=nt>author</span><span class=p>:</span><span class=w> </span><span class=s>"Security</span><span class=nv> </span><span class=s>Engineering</span><span class=nv> </span><span class=s>Team"</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s>"2.1.0"</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=nt>license</span><span class=p>:</span><span class=w> </span><span class=s>"MIT"</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=nt>homepage</span><span class=p>:</span><span class=w> </span><span class=s>"https://github.com/company/advanced-pii-filter"</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class=s>"https://github.com/company/advanced-pii-filter.git"</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=c1># Plugin capabilities and hook registration</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=nt>available_hooks</span><span class=p>:</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"prompt_pre_fetch"</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"prompt_post_fetch"</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"tool_pre_invoke"</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"tool_post_invoke"</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"resource_post_fetch"</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=c1># Categorization and discovery</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=nt>tags</span><span class=p>:</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"security"</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"pii"</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"compliance"</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"data-protection"</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"gdpr"</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=c1># Plugin characteristics</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=nt>plugin_type</span><span class=p>:</span><span class=w> </span><span class=s>"native"</span><span class=w>                    </span><span class=c1># native | external</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=nt>language</span><span class=p>:</span><span class=w> </span><span class=s>"python"</span><span class=w>                       </span><span class=c1># python | typescript | go | rust | java</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=nt>performance_tier</span><span class=p>:</span><span class=w> </span><span class=s>"high"</span><span class=w>                 </span><span class=c1># high | medium | low (expected latency)</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=c1># Default configuration template</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a><span class=nt>default_config</span><span class=p>:</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=w>  </span><span class=nt>detection_sensitivity</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0.8</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=w>  </span><span class=nt>masking_strategy</span><span class=p>:</span><span class=w> </span><span class=s>"partial"</span><span class=w>             </span><span class=c1># partial | full | token</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=w>  </span><span class=nt>pii_types</span><span class=p>:</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"ssn"</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"credit_card"</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"email"</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"phone"</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=w>  </span><span class=nt>compliance_mode</span><span class=p>:</span><span class=w> </span><span class=s>"gdpr"</span><span class=w>                 </span><span class=c1># gdpr | hipaa | pci | custom</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=w>  </span><span class=nt>log_violations</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a><span class=w>  </span><span class=nt>max_content_length</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1048576</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=c1># Runtime requirements</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a><span class=nt>requirements</span><span class=p>:</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=w>  </span><span class=nt>python_version</span><span class=p>:</span><span class=w> </span><span class=s>"&gt;=3.11"</span>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a><span class=w>  </span><span class=nt>memory_mb</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a><span class=w>  </span><span class=nt>cpu_cores</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a><span class=w>  </span><span class=nt>timeout_seconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a><span class=c1># Dependencies (for external plugins)</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a><span class=nt>dependencies</span><span class=p>:</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"spacy&gt;=3.4.0"</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"presidio-analyzer&gt;=2.2.0"</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>"pydantic&gt;=2.0.0"</span>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a><span class=c1># Plugin metadata for advanced features</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a><span class=nt>features</span><span class=p>:</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a><span class=w>  </span><span class=nt>configurable</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w>                      </span><span class=c1># Plugin accepts runtime configuration</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a><span class=w>  </span><span class=nt>stateful</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>                         </span><span class=c1># Plugin maintains state between requests</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a><span class=w>  </span><span class=nt>async_capable</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w>                     </span><span class=c1># Plugin supports async execution</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a><span class=w>  </span><span class=nt>external_dependencies</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w>             </span><span class=c1># Plugin requires external services</span>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a><span class=w>  </span><span class=nt>multi_tenant</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w>                      </span><span class=c1># Plugin supports tenant isolation</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a><span class=c1># Documentation and examples</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a><span class=nt>documentation</span><span class=p>:</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a><span class=w>  </span><span class=nt>readme</span><span class=p>:</span><span class=w> </span><span class=s>"README.md"</span>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a><span class=w>  </span><span class=nt>examples</span><span class=p>:</span><span class=w> </span><span class=s>"examples/"</span>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a><span class=w>  </span><span class=nt>api_docs</span><span class=p>:</span><span class=w> </span><span class=s>"docs/api.md"</span>
</span><span id=__span-1-75><a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a>
</span><span id=__span-1-76><a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a><span class=c1># Testing and quality assurance</span>
</span><span id=__span-1-77><a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a><span class=nt>testing</span><span class=p>:</span>
</span><span id=__span-1-78><a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a><span class=w>  </span><span class=nt>unit_tests</span><span class=p>:</span><span class=w> </span><span class=s>"tests/unit/"</span>
</span><span id=__span-1-79><a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a><span class=w>  </span><span class=nt>integration_tests</span><span class=p>:</span><span class=w> </span><span class=s>"tests/integration/"</span>
</span><span id=__span-1-80><a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a><span class=w>  </span><span class=nt>coverage_threshold</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
</span><span id=__span-1-81><a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a>
</span><span id=__span-1-82><a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a><span class=c1># Compatibility and versioning</span>
</span><span id=__span-1-83><a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a><span class=nt>compatibility</span><span class=p>:</span>
</span><span id=__span-1-84><a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a><span class=w>  </span><span class=nt>min_framework_version</span><span class=p>:</span><span class=w> </span><span class=s>"1.0.0"</span>
</span><span id=__span-1-85><a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a><span class=w>  </span><span class=nt>max_framework_version</span><span class=p>:</span><span class=w> </span><span class=s>"2.x.x"</span>
</span><span id=__span-1-86><a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a><span class=w>  </span><span class=nt>python_versions</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>"3.11"</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>"3.12"</span><span class="p p-Indicator">]</span>
</span><span id=__span-1-87><a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a>
</span><span id=__span-1-88><a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a><span class=c1># Optional deployment metadata</span>
</span><span id=__span-1-89><a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a><span class=nt>deployment</span><span class=p>:</span>
</span><span id=__span-1-90><a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a><span class=w>  </span><span class=nt>container_image</span><span class=p>:</span><span class=w> </span><span class=s>"company/pii-filter:2.1.0"</span>
</span><span id=__span-1-91><a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a><span class=w>  </span><span class=nt>k8s_manifest</span><span class=p>:</span><span class=w> </span><span class=s>"k8s/deployment.yaml"</span>
</span><span id=__span-1-92><a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a><span class=w>  </span><span class=nt>health_check_endpoint</span><span class=p>:</span><span class=w> </span><span class=s>"/health"</span>
</span></code></pre></div> <h4 id=manifest-fields-reference>Manifest Fields Reference<a class=headerlink href=#manifest-fields-reference title="Permanent link">¶</a></h4> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Required</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><code>name</code></td> <td><code>string</code></td> <td>Yes</td> <td>Human-readable plugin name</td> <td><code>"Advanced PII Filter"</code></td> </tr> <tr> <td><code>kind</code></td> <td><code>string</code></td> <td>Yes</td> <td>Plugin class path</td> <td><code>"plugins.pii_filter.pii_filter.PIIFilterPlugin"</code></td> </tr> <tr> <td><code>description</code></td> <td><code>string</code></td> <td>Yes</td> <td>Detailed plugin description</td> <td><code>"Comprehensive PII detection with GDPR compliance"</code></td> </tr> <tr> <td><code>author</code></td> <td><code>string</code></td> <td>Yes</td> <td>Plugin author or team</td> <td><code>"Security Engineering Team"</code></td> </tr> <tr> <td><code>version</code></td> <td><code>string</code></td> <td>Yes</td> <td>Semantic version</td> <td><code>"2.1.0"</code></td> </tr> <tr> <td><code>license</code></td> <td><code>string</code></td> <td></td> <td>License identifier</td> <td><code>"MIT"</code>, <code>"Apache-2.0"</code></td> </tr> <tr> <td><code>homepage</code></td> <td><code>string</code></td> <td></td> <td>Plugin homepage URL</td> <td><code>"https://github.com/company/plugin"</code></td> </tr> <tr> <td><code>repository</code></td> <td><code>string</code></td> <td></td> <td>Source code repository</td> <td><code>"https://github.com/company/plugin.git"</code></td> </tr> </tbody> </table> <h4 id=plugin-capability-fields>Plugin Capability Fields<a class=headerlink href=#plugin-capability-fields title="Permanent link">¶</a></h4> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Description</th> <th>Values</th> </tr> </thead> <tbody> <tr> <td><code>available_hooks</code></td> <td><code>string[]</code></td> <td>Hook points the plugin can implement</td> <td><code>["prompt_pre_fetch", "tool_pre_invoke"]</code></td> </tr> <tr> <td><code>plugin_type</code></td> <td><code>string</code></td> <td>Plugin architecture type</td> <td><code>"native"</code>, <code>"external"</code></td> </tr> <tr> <td><code>language</code></td> <td><code>string</code></td> <td>Implementation language</td> <td><code>"python"</code>, <code>"typescript"</code>, <code>"go"</code>, <code>"rust"</code></td> </tr> <tr> <td><code>performance_tier</code></td> <td><code>string</code></td> <td>Expected latency characteristics</td> <td><code>"high"</code> (&lt;1ms), <code>"medium"</code> (&lt;10ms), <code>"low"</code> (&lt;100ms)</td> </tr> </tbody> </table> <h4 id=configuration-and-dependencies>Configuration and Dependencies<a class=headerlink href=#configuration-and-dependencies title="Permanent link">¶</a></h4> <table> <thead> <tr> <th>Field</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>default_config</code></td> <td><code>object</code></td> <td>Default plugin configuration template</td> </tr> <tr> <td><code>requirements</code></td> <td><code>object</code></td> <td>Runtime resource requirements</td> </tr> <tr> <td><code>dependencies</code></td> <td><code>string[]</code></td> <td>External package dependencies</td> </tr> <tr> <td><code>features</code></td> <td><code>object</code></td> <td>Plugin capability flags</td> </tr> </tbody> </table> <h2 id=core-components>Core Components<a class=headerlink href=#core-components title="Permanent link">¶</a></h2> <h3 id=core-framework-structure>Core Framework Structure<a class=headerlink href=#core-framework-structure title="Permanent link">¶</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>mcpgateway/plugins/framework/
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>├── base.py              # Plugin base classes and PluginRef
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>├── models.py            # Pydantic models for all plugin types
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>├── manager.py           # PluginManager singleton with lifecycle management
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>├── registry.py          # Plugin instance registry and discovery
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>├── constants.py         # Framework constants and enums
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>├── errors.py            # Plugin-specific exception types
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>├── utils.py             # Utility functions for plugin operations
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>├── loader/
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>│   ├── config.py        # Configuration loading and validation
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>│   └── plugin.py        # Dynamic plugin loading and instantiation
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>└── external/
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>    └── mcp/             # MCP external service integration
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>        ├── client.py    # MCP client for external plugin communication
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>        └── server/      # MCP server runtime for plugin hosting
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>            ├── server.py    # MCP server implementation
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>            └── runtime.py   # Plugin runtime management
</span></code></pre></div> <h3 id=base-plugin-class>Base Plugin Class<a class=headerlink href=#base-plugin-class title="Permanent link">¶</a></h3> <p>The base plugin class, of which developers subclass and implement the hooks that are important for their plugins. Hook points are functions that interpose on existing MCP and agent-based functionality.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>class</span><span class=w> </span><span class=nc>Plugin</span><span class=p>:</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=sd>"""Base plugin class for self-contained, in-process plugins"""</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>PluginConfig</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>        </span><span class=sd>"""Initialize plugin with configuration"""</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    <span class=nd>@property</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>    <span class=k>def</span><span class=w> </span><span class=nf>name</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>        </span><span class=sd>"""Plugin name"""</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=nd>@property</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>    <span class=k>def</span><span class=w> </span><span class=nf>priority</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w>        </span><span class=sd>"""Plugin execution priority (lower = higher priority)"""</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>    <span class=nd>@property</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>    <span class=k>def</span><span class=w> </span><span class=nf>mode</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PluginMode</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=w>        </span><span class=sd>"""Plugin execution mode (enforce/permissive/disabled)"""</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>    <span class=nd>@property</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>    <span class=k>def</span><span class=w> </span><span class=nf>hooks</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>HookType</span><span class=p>]:</span> <span class=o>...</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=w>        </span><span class=sd>"""Hook points where plugin executes"""</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>    <span class=nd>@property</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>    <span class=k>def</span><span class=w> </span><span class=nf>conditions</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>PluginCondition</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=w>        </span><span class=sd>"""Conditions for plugin execution"""</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>initialize</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=w>        </span><span class=sd>"""Initialize plugin resources"""</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>shutdown</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=w>        </span><span class=sd>"""Cleanup plugin resources"""</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a>    <span class=c1># Hook methods (implemented by subclasses)</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prompt_pre_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>PromptPrehookPayload</span><span class=p>,</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>                              <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PromptPrehookResult</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prompt_post_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>PromptPosthookPayload</span><span class=p>,</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a>                               <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PromptPosthookResult</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>tool_pre_invoke</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ToolPreInvokePayload</span><span class=p>,</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a>                             <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ToolPreInvokeResult</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>tool_post_invoke</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ToolPostInvokePayload</span><span class=p>,</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a>                              <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ToolPostInvokeResult</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>resource_pre_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ResourcePreFetchPayload</span><span class=p>,</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a>                                <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ResourcePreFetchResult</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>resource_post_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ResourcePostFetchPayload</span><span class=p>,</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a>                                 <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ResourcePostFetchResult</span><span class=p>:</span> <span class=o>...</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a>    <span class=c1># ... additional hook methods</span>
</span></code></pre></div> <h3 id=plugin-manager>Plugin Manager<a class=headerlink href=#plugin-manager title="Permanent link">¶</a></h3> <p>The Plugin Manager loads configured plugins and executes them at their designated hook points based on a plugin's priority.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>class</span><span class=w> </span><span class=nc>PluginManager</span><span class=p>:</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=sd>"""Singleton plugin manager for lifecycle management"""</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>""</span><span class=p>,</span> <span class=n>timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>30</span><span class=p>):</span> <span class=o>...</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=nd>@property</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>    <span class=k>def</span><span class=w> </span><span class=nf>config</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Config</span> <span class=o>|</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>        </span><span class=sd>"""Plugin manager configuration"""</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>    <span class=nd>@property</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=k>def</span><span class=w> </span><span class=nf>plugin_count</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>        </span><span class=sd>"""Number of loaded plugins"""</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>    <span class=nd>@property</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=k>def</span><span class=w> </span><span class=nf>initialized</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=w>        </span><span class=sd>"""Manager initialization status"""</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>initialize</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=w>        </span><span class=sd>"""Initialize manager and load plugins"""</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>shutdown</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=w>        </span><span class=sd>"""Shutdown all plugins and cleanup"""</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_plugin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Plugin</span><span class=p>]:</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=w>        </span><span class=sd>"""Get plugin by name"""</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>    <span class=c1># Hook execution methods</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prompt_pre_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>PromptPrehookPayload</span><span class=p>,</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a>                              <span class=n>global_context</span><span class=p>:</span> <span class=n>GlobalContext</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>PromptPrehookResult</span><span class=p>,</span> <span class=n>PluginContextTable</span><span class=p>]:</span> <span class=o>...</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prompt_post_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>PromptPosthookPayload</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>PromptPosthookResult</span><span class=p>,</span> <span class=n>PluginContextTable</span><span class=p>]:</span> <span class=o>...</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>tool_pre_invoke</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ToolPreInvokePayload</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>ToolPreInvokeResult</span><span class=p>,</span> <span class=n>PluginContextTable</span><span class=p>]:</span> <span class=o>...</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>tool_post_invoke</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ToolPostInvokePayload</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>ToolPostInvokeResult</span><span class=p>,</span> <span class=n>PluginContextTable</span><span class=p>]:</span> <span class=o>...</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>resource_pre_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ResourcePreFetchPayload</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>ResourcePreFetchResult</span><span class=p>,</span> <span class=n>PluginContextTable</span><span class=p>]:</span> <span class=o>...</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>resource_post_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ResourcePostFetchPayload</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>ResourcePostFetchResult</span><span class=p>,</span> <span class=n>PluginContextTable</span><span class=p>]:</span> <span class=o>...</span>
</span></code></pre></div> <h3 id=plugin-registry>Plugin Registry<a class=headerlink href=#plugin-registry title="Permanent link">¶</a></h3> <p>The plugin registry implements plugin instance management and discovery.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>class</span><span class=w> </span><span class=nc>PluginInstanceRegistry</span><span class=p>:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=sd>"""Registry for plugin instance management and discovery"""</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=k>def</span><span class=w> </span><span class=nf>register</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>plugin</span><span class=p>:</span> <span class=n>Plugin</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>        </span><span class=sd>"""Register a plugin instance"""</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>    <span class=k>def</span><span class=w> </span><span class=nf>unregister</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>        </span><span class=sd>"""Unregister a plugin by name"""</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_plugin</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>PluginRef</span><span class=p>]:</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>        </span><span class=sd>"""Get plugin reference by name"""</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_plugins_for_hook</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>hook_type</span><span class=p>:</span> <span class=n>HookType</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>PluginRef</span><span class=p>]:</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>        </span><span class=sd>"""Get all plugins registered for a specific hook"""</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_all_plugins</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>PluginRef</span><span class=p>]:</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>        </span><span class=sd>"""Get all registered plugins"""</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>    <span class=nd>@property</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>    <span class=k>def</span><span class=w> </span><span class=nf>plugin_count</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=w>        </span><span class=sd>"""Number of registered plugins"""</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>shutdown</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=w>        </span><span class=sd>"""Shutdown all registered plugins"""</span>
</span></code></pre></div> <h3 id=plugin-reference-system>Plugin Reference System<a class=headerlink href=#plugin-reference-system title="Permanent link">¶</a></h3> <p>Plugin reference is used as UUID for plugin registration, discovery, and lifecycle management.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>class</span><span class=w> </span><span class=nc>PluginRef</span><span class=p>:</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class=sd>"""Plugin reference with UUID tracking for lifecycle management"""</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>plugin</span><span class=p>:</span> <span class=n>Plugin</span><span class=p>):</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_plugin</span> <span class=o>=</span> <span class=n>plugin</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_uuid</span> <span class=o>=</span> <span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span>  <span class=c1># Unique instance identifier</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=nd>@property</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=k>def</span><span class=w> </span><span class=nf>plugin</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Plugin</span><span class=p>:</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_plugin</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>    <span class=nd>@property</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>    <span class=k>def</span><span class=w> </span><span class=nf>uuid</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_uuid</span><span class=o>.</span><span class=n>hex</span>
</span></code></pre></div> <h3 id=configuration-loading>Configuration Loading<a class=headerlink href=#configuration-loading title="Permanent link">¶</a></h3> <p>The Configuration Loader provides utilities for loading configuration from file.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>class</span><span class=w> </span><span class=nc>ConfigLoader</span><span class=p>:</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span><span class=sd>"""Configuration loading and validation"""</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=k>def</span><span class=w> </span><span class=nf>load_config</span><span class=p>(</span><span class=n>config_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Config</span><span class=p>:</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>        </span><span class=sd>"""Load plugin configuration from YAML file"""</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=k>def</span><span class=w> </span><span class=nf>validate_config</span><span class=p>(</span><span class=n>config</span><span class=p>:</span> <span class=n>Config</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>        </span><span class=sd>"""Validate plugin configuration"""</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>    <span class=k>def</span><span class=w> </span><span class=nf>merge_configs</span><span class=p>(</span><span class=n>base</span><span class=p>:</span> <span class=n>Config</span><span class=p>,</span> <span class=n>override</span><span class=p>:</span> <span class=n>Config</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Config</span><span class=p>:</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=w>        </span><span class=sd>"""Merge configuration files"""</span>
</span></code></pre></div> <h3 id=plugin-configuration-models>Plugin Configuration Models<a class=headerlink href=#plugin-configuration-models title="Permanent link">¶</a></h3> <p>Below are the Pydantic models for the plugin configuration system.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>class</span><span class=w> </span><span class=nc>PluginConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>    </span><span class=sd>"""Plugin configuration schema"""</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>                                    <span class=c1># Required: Unique plugin name</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=n>kind</span><span class=p>:</span> <span class=nb>str</span>                                    <span class=c1># Required: Plugin class path or "external"</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=n>description</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>            <span class=c1># Plugin description</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>author</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>                 <span class=c1># Plugin author</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>version</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>                <span class=c1># Plugin version</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>    <span class=n>hooks</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=n>HookType</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>       <span class=c1># Hook points to register</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>    <span class=n>tags</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>             <span class=c1># Searchable tags</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=n>mode</span><span class=p>:</span> <span class=n>PluginMode</span> <span class=o>=</span> <span class=n>PluginMode</span><span class=o>.</span><span class=n>ENFORCE</span>        <span class=c1># Execution mode</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=n>priority</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>               <span class=c1># Execution priority</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>    <span class=n>conditions</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=n>PluginCondition</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span> <span class=c1># Execution conditions</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>    <span class=n>config</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>      <span class=c1># Plugin-specific settings</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>    <span class=n>mcp</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>MCPConfig</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>              <span class=c1># External MCP server configuration</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=k>class</span><span class=w> </span><span class=nc>PluginCondition</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>    <span class=n>server_ids</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>        <span class=c1># Target server IDs</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>    <span class=n>tenant_ids</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>        <span class=c1># Target tenant IDs</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>    <span class=n>tools</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>             <span class=c1># Target tool names</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>    <span class=n>prompts</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>           <span class=c1># Target prompt names</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>    <span class=n>resources</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>         <span class=c1># Target resource URIs</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>    <span class=n>user_patterns</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>    <span class=c1># User pattern matching</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>    <span class=n>content_types</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>    <span class=c1># Content type filtering</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=k>class</span><span class=w> </span><span class=nc>MCPConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=w>    </span><span class=sd>"""MCP configuration for external plugins"""</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>    <span class=n>proto</span><span class=p>:</span> <span class=n>TransportType</span>                     <span class=c1># STDIO, SSE, or STREAMABLEHTTP</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>    <span class=n>url</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>                <span class=c1># Service URL (for HTTP transports)</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>    <span class=n>script</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>             <span class=c1># Script path (for STDIO transport)</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=k>class</span><span class=w> </span><span class=nc>PluginMode</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Enum</span><span class=p>):</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=w>    </span><span class=sd>"""Plugin execution modes"""</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>    <span class=n>ENFORCE</span> <span class=o>=</span> <span class=s2>"enforce"</span>              <span class=c1># Block requests that violate plugin rules</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a>    <span class=n>ENFORCE_IGNORE_ERROR</span> <span class=o>=</span> <span class=s2>"enforce_ignore_error"</span>  <span class=c1># Enforce rules, ignore errors</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>    <span class=n>PERMISSIVE</span> <span class=o>=</span> <span class=s2>"permissive"</span>        <span class=c1># Log violations but allow continuation</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a>    <span class=n>DISABLED</span> <span class=o>=</span> <span class=s2>"disabled"</span>            <span class=c1># Plugin loaded but not executed</span>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=k>class</span><span class=w> </span><span class=nc>HookType</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Enum</span><span class=p>):</span>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a><span class=w>    </span><span class=sd>"""Available hook points in MCP request lifecycle"""</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>    <span class=n>PROMPT_PRE_FETCH</span> <span class=o>=</span> <span class=s2>"prompt_pre_fetch"</span>     <span class=c1># Before prompt retrieval</span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a>    <span class=n>PROMPT_POST_FETCH</span> <span class=o>=</span> <span class=s2>"prompt_post_fetch"</span>   <span class=c1># After prompt rendering</span>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a>    <span class=n>TOOL_PRE_INVOKE</span> <span class=o>=</span> <span class=s2>"tool_pre_invoke"</span>       <span class=c1># Before tool execution</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a>    <span class=n>TOOL_POST_INVOKE</span> <span class=o>=</span> <span class=s2>"tool_post_invoke"</span>     <span class=c1># After tool execution</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a>    <span class=n>RESOURCE_PRE_FETCH</span> <span class=o>=</span> <span class=s2>"resource_pre_fetch"</span> <span class=c1># Before resource fetching</span>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a>    <span class=n>RESOURCE_POST_FETCH</span> <span class=o>=</span> <span class=s2>"resource_post_fetch"</span> <span class=c1># After resource retrieval</span>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a><span class=k>class</span><span class=w> </span><span class=nc>TransportType</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>Enum</span><span class=p>):</span>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a><span class=w>    </span><span class=sd>"""Supported MCP transport protocols"""</span>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a>    <span class=n>SSE</span> <span class=o>=</span> <span class=s2>"sse"</span>                        <span class=c1># Server-Sent Events</span>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a>    <span class=n>HTTP</span> <span class=o>=</span> <span class=s2>"http"</span>                      <span class=c1># HTTP</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a>    <span class=n>STDIO</span> <span class=o>=</span> <span class=s2>"stdio"</span>                    <span class=c1># Standard input/output</span>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a>    <span class=n>STREAMABLEHTTP</span> <span class=o>=</span> <span class=s2>"streamablehttp"</span>  <span class=c1># HTTP with streaming support</span>
</span></code></pre></div> <h3 id=context-management>Context Management<a class=headerlink href=#context-management title="Permanent link">¶</a></h3> <h4 id=plugin-context-system>Plugin Context System<a class=headerlink href=#plugin-context-system title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>class</span><span class=w> </span><span class=nc>GlobalContext</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>    </span><span class=sd>"""Shared context across all plugins in a request"""</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>    <span class=n>request_id</span><span class=p>:</span> <span class=nb>str</span>                  <span class=c1># Unique request identifier</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>    <span class=n>user</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>       <span class=c1># User making the request</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=n>tenant_id</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># Tenant context</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>    <span class=n>server_id</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># Virtual server context</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=k>class</span><span class=w> </span><span class=nc>PluginContext</span><span class=p>(</span><span class=n>GlobalContext</span><span class=p>):</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>    </span><span class=sd>"""Per-plugin context with state management"""</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>    <span class=n>state</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>       <span class=c1># Cross-plugin shared state</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>    <span class=n>metadata</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>    <span class=c1># Plugin execution metadata</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_state</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>default</span><span class=p>:</span> <span class=n>Any</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=w>        </span><span class=sd>"""Get value from shared state"""</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>default</span><span class=p>)</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>    <span class=k>def</span><span class=w> </span><span class=nf>set_state</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=w>        </span><span class=sd>"""Set value in shared state"""</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>        <span class=bp>self</span><span class=o>.</span><span class=n>state</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span></code></pre></div> <h4 id=context-lifecycle-management>Context Lifecycle Management<a class=headerlink href=#context-lifecycle-management title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>class</span><span class=w> </span><span class=nc>PluginManager</span><span class=p>:</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=c1># Context cleanup tracking</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>_context_store</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>PluginContextTable</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>_last_cleanup</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>_cleanup_old_contexts</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>        </span><span class=sd>"""Remove contexts older than CONTEXT_MAX_AGE to prevent memory leaks"""</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>        <span class=n>current_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>        <span class=k>if</span> <span class=n>current_time</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>_last_cleanup</span> <span class=o>&lt;</span> <span class=n>CONTEXT_CLEANUP_INTERVAL</span><span class=p>:</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>            <span class=k>return</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>        <span class=c1># Find and remove expired contexts</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>        <span class=n>expired_keys</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>            <span class=n>key</span> <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=p>(</span><span class=n>_</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>)</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_context_store</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>            <span class=k>if</span> <span class=n>current_time</span> <span class=o>-</span> <span class=n>timestamp</span> <span class=o>&gt;</span> <span class=n>CONTEXT_MAX_AGE</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>        <span class=p>]</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>expired_keys</span><span class=p>:</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>            <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>_context_store</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></code></pre></div> <h2 id=hook-system>Hook System<a class=headerlink href=#hook-system title="Permanent link">¶</a></h2> <h3 id=hook-execution-flow>Hook Execution Flow<a class=headerlink href=#hook-execution-flow title="Permanent link">¶</a></h3> <p>The hook execution flow implements a <strong>priority-based pipeline</strong> that processes MCP requests through multiple plugin layers before reaching core gateway logic. This architecture ensures predictable plugin execution order while enabling comprehensive request/response transformation and policy enforcement.</p> <pre class=mermaid><code>---
config:
  mirrorActors: false
---
sequenceDiagram
    participant Client
    participant Gateway
    participant PM as PluginManager
    participant P1 as Plugin 1 (Priority 10)
    participant P2 as Plugin 2 (Priority 20)
    participant Core as Core Logic

    Client-&gt;&gt;Gateway: MCP Request
    Gateway-&gt;&gt;PM: Execute Hook (e.g., tool_pre_invoke)

    PM-&gt;&gt;P1: Execute (higher priority)
    P1--&gt;&gt;PM: Result (continue=true, modified_payload)

    PM-&gt;&gt;P2: Execute with modified payload
    P2--&gt;&gt;PM: Result (continue=true)

    PM--&gt;&gt;Gateway: Final Result

    alt Continue Processing
        Gateway-&gt;&gt;Core: Execute Core Logic
        Core--&gt;&gt;Gateway: Response
        Gateway--&gt;&gt;Client: Success Response
    else Block Request
        Gateway--&gt;&gt;Client: Violation Response
    end</code></pre> <h4 id=execution-flow-breakdown>Execution Flow Breakdown<a class=headerlink href=#execution-flow-breakdown title="Permanent link">¶</a></h4> <p><strong>Phase 1</strong>: Request Reception &amp; Hook Identification</p> <ol> <li>Client Request: MCP client sends request (tool invocation, prompt fetch, resource access) to the gateway</li> <li>Hook Selection: Gateway identifies the appropriate hook type based on the request (e.g., <code>tool_pre_invoke</code> for tool calls)</li> <li>Plugin Manager Invocation: Gateway delegates hook execution to the Plugin Manager with request payload</li> </ol> <p><strong>Phase 2</strong>: Priority-Based Plugin Execution</p> <ol> <li>Plugin Discovery: Plugin Manager retrieves all plugins registered for the specific hook type</li> <li>Priority Sorting: Plugins are sorted in <strong>ascending priority order</strong> (lower numbers execute first)</li> <li>Conditional Filtering: Plugins with conditions are filtered based on current request context (user, tenant, server, etc.)</li> </ol> <p><strong>Phase 3</strong>: Sequential Plugin Processing</p> <ol> <li>First Plugin Execution: Highest priority plugin (P1, priority 10) executes with original payload</li> <li>Result Evaluation: Plugin returns <code>PluginResult</code> indicating whether to continue processing</li> <li>Payload Chain: If P1 modifies the payload, the modified version is passed to the next plugin</li> <li>Second Plugin Execution: Next priority plugin (P2, priority 20) executes with potentially modified payload</li> <li>Continue Chain: Process repeats for all remaining plugins in priority order</li> </ol> <p><strong>Phase 4</strong>: Flow Control Decision</p> <ol> <li>Aggregated Result: Plugin Manager combines all plugin results and determines final action</li> <li>Continue vs Block: Based on plugin results, request either continues to core logic or is blocked</li> </ol> <p><strong>Phase 5</strong>: Request Resolution</p> <ul> <li>Continue Path: If all plugins allow processing, request continues to core gateway logic</li> <li>Core logic executes the actual MCP operation (tool invocation, prompt rendering, resource fetching)</li> <li>Success response is returned to client</li> <li>Block Path: If any plugin blocks the request with a violation</li> <li>Request processing stops immediately</li> <li>Violation details are returned to client as an error response</li> </ul> <h4 id=plugin-interaction-patterns>Plugin Interaction Patterns<a class=headerlink href=#plugin-interaction-patterns title="Permanent link">¶</a></h4> <p><strong>Payload Transformation Chain:</strong></p> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>Original Payload → Plugin 1 → Modified Payload → Plugin 2 → Final Payload → Core Logic
</span></code></pre></div> <p><strong>Example Flow for Tool Pre-Invoke:</strong></p> <ol> <li>Client calls <code>file_reader</code> tool with path argument</li> <li>Gateway triggers <code>tool_pre_invoke</code> hook</li> <li><strong>Security Plugin (Priority 10)</strong>: Validates file path, blocks access to <code>/etc/passwd</code></li> <li><strong>Sanitization Plugin (Priority 20)</strong>: Never executes (request blocked)</li> <li><strong>Result</strong>: Client receives "Access Denied" error</li> </ol> <p><strong>Alternative Success Flow:</strong></p> <ol> <li>Client calls <code>file_reader</code> tool with path <code>./documents/report.txt</code></li> <li><strong>Security Plugin (Priority 10)</strong>: Validates path, allows access, normalizes path</li> <li><strong>Sanitization Plugin (Priority 20)</strong>: Adds read timeout, limits file size</li> <li><strong>Core Logic</strong>: Executes file reading with sanitized parameters</li> <li><strong>Result</strong>: Client receives file contents</li> </ol> <h4 id=error-handling-and-resilience>Error Handling and Resilience<a class=headerlink href=#error-handling-and-resilience title="Permanent link">¶</a></h4> <p><strong>Plugin Error Isolation:</strong></p> <ul> <li>Plugin execution errors don't crash other plugins or the gateway</li> <li>Failed plugins are logged and handled based on their execution mode:</li> <li><strong>Enforce Mode</strong>: Plugin errors block the request</li> <li><strong>Permissive Mode</strong>: Plugin errors are logged but request continues</li> <li><strong>Enforce Ignore Error Mode</strong>: Plugin violations block, but technical errors are ignored</li> </ul> <p><strong>Timeout Protection:</strong></p> <ul> <li>Each plugin execution is wrapped with configurable timeouts (default 30 seconds)</li> <li>Timed-out plugins are treated as errors according to their execution mode</li> <li>External plugins may have longer timeout allowances due to network latency</li> </ul> <p><strong>Context Preservation:</strong></p> <ul> <li>Plugin contexts are preserved across the execution chain</li> <li>State set by early plugins is available to later plugins</li> <li>Global context maintains request-level information throughout the flow</li> </ul> <p>This execution model ensures <strong>predictable behavior</strong>, <strong>comprehensive security coverage</strong>, and <strong>operational resilience</strong> while maintaining the flexibility to implement complex policy enforcement and content transformation workflows.</p> <h4 id=plugin-execution-priority>Plugin Execution Priority<a class=headerlink href=#plugin-execution-priority title="Permanent link">¶</a></h4> <ul> <li>Plugins execute in <strong>ascending priority order</strong> (lower number = higher priority)</li> <li><strong>Priority Ranges</strong> (recommended):</li> <li><code>1-50</code>: Critical security plugins (authentication, PII filtering)</li> <li><code>51-100</code>: Content filtering and validation</li> <li><code>101-200</code>: Transformations and enhancements</li> <li><code>201+</code>: Logging and monitoring</li> </ul> <h4 id=hook-registration>Hook Registration<a class=headerlink href=#hook-registration title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># Plugin registers for specific hooks via configuration</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=n>hooks</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>HookType</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=n>HookType</span><span class=o>.</span><span class=n>PROMPT_PRE_FETCH</span><span class=p>,</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>    <span class=n>HookType</span><span class=o>.</span><span class=n>TOOL_PRE_INVOKE</span><span class=p>,</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>    <span class=n>HookType</span><span class=o>.</span><span class=n>TOOL_POST_INVOKE</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=p>]</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=c1># Plugin Manager routes hooks to registered plugins</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=n>plugins</span> <span class=o>=</span> <span class=n>registry</span><span class=o>.</span><span class=n>get_plugins_for_hook</span><span class=p>(</span><span class=n>HookType</span><span class=o>.</span><span class=n>TOOL_PRE_INVOKE</span><span class=p>)</span>
</span></code></pre></div> <h4 id=conditional-execution>Conditional Execution<a class=headerlink href=#conditional-execution title="Permanent link">¶</a></h4> <p>Plugins can specify conditions for when they should execute:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>class</span><span class=w> </span><span class=nc>PluginCondition</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>    </span><span class=sd>"""Conditions for plugin execution"""</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>    <span class=n>server_ids</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>      <span class=c1># Execute only for specific servers</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>    <span class=n>tenant_ids</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>      <span class=c1># Execute only for specific tenants</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>    <span class=n>tools</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>           <span class=c1># Execute only for specific tools</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>    <span class=n>prompts</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>         <span class=c1># Execute only for specific prompts</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>    <span class=n>resources</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>set</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>       <span class=c1># Execute only for specific resources</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=n>user_patterns</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># Execute for users matching patterns</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>    <span class=n>content_types</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>  <span class=c1># Execute for specific content types</span>
</span></code></pre></div> <h2 id=hook-reference-documentation>Hook Reference Documentation<a class=headerlink href=#hook-reference-documentation title="Permanent link">¶</a></h2> <p>The plugin framework provides two main categories of hooks, each documented in detail in separate files:</p> <h3 id=mcp-security-hooks>MCP Security Hooks<a class=headerlink href=#mcp-security-hooks title="Permanent link">¶</a></h3> <p>For detailed information about MCP protocol security hooks including payload structures, examples, and use cases, see:</p> <p><strong><a href=security-hooks/ >MCP Security Hooks Reference</a></strong></p> <h3 id=gateway-administrative-hooks>Gateway Administrative Hooks<a class=headerlink href=#gateway-administrative-hooks title="Permanent link">¶</a></h3> <p>For detailed information about gateway management and administrative hooks, see:</p> <p><strong><a href=gateway-hooks/ >Gateway Administrative Hooks Reference</a></strong></p> <h2 id=external-plugin-integration>External Plugin Integration<a class=headerlink href=#external-plugin-integration title="Permanent link">¶</a></h2> <h3 id=plugin-lifecycle>Plugin Lifecycle<a class=headerlink href=#plugin-lifecycle title="Permanent link">¶</a></h3> <p>The plugin framework provides comprehensive lifecycle management for both native and external plugins, encompassing the complete journey from development to production deployment. The lifecycle follows a structured workflow designed to ensure plugin quality, security, and operational reliability.</p> <h4 id=development-workflow>Development Workflow<a class=headerlink href=#development-workflow title="Permanent link">¶</a></h4> <p>The plugin development process follows a streamlined four-phase approach that gets developers from concept to running plugin quickly:</p> <pre class=mermaid><code>graph LR
    A["Template"]
    B(["Bootstrap"])
    C(["Build"])
    D(["Serve"])

    subgraph dev["Development Phase"]
        A -.-&gt; B
    end

    subgraph deploy["Deployment Phase"]
        C --&gt; D
    end

    B --&gt; C

    subgraph CF["Context Forge Gateway"]
        E["Gateway"]
        D o--"MCP&lt;br&gt;&amp;nbsp;&amp;nbsp;&lt;small&gt;tools/hooks&lt;/small&gt;&amp;nbsp;&amp;nbsp;"--o E
    end

    style A stroke-dasharray: 3 3;</code></pre> <p><strong>Phase Breakdown:</strong></p> <ol> <li><strong>Bootstrap Phase</strong>: Initialize project structure from templates with metadata and configuration</li> <li><strong>Build Phase</strong>: Compile, package, and validate plugin code with dependencies</li> <li><strong>Serve Phase</strong>: Launch development server for testing and integration validation</li> <li><strong>Integration Phase</strong>: Connect to Context Forge gateway via MCP protocol for end-to-end testing</li> </ol> <h4 id=plugin-types-and-templates>Plugin Types and Templates<a class=headerlink href=#plugin-types-and-templates title="Permanent link">¶</a></h4> <p>The framework supports two primary plugin architectures with dedicated development templates:</p> <h5 id=native-plugins>Native Plugins<a class=headerlink href=#native-plugins title="Permanent link">¶</a></h5> <ul> <li><strong>Architecture</strong>: Run in-process within the gateway</li> <li><strong>Language</strong>: Python only</li> <li><strong>Performance</strong>: lowest latency, direct memory access</li> <li><strong>Use Cases</strong>: High-frequency operations, simple transformations, core security checks</li> </ul> <p><strong>Template Structure:</strong> </p><div class="language-text highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>plugin_templates/native/
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>├── plugin.py.jinja              # Plugin class skeleton extending Plugin base
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>├── plugin-manifest.yaml.jinja   # Metadata (description, author, version, hooks)
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>├── config.yaml.jinja            # Configuration entry for plugins/config.yaml
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>├── __init__.py.jinja            # Package initialization
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>└── README.md.jinja              # Documentation template
</span></code></pre></div><p></p> <h5 id=external-plugins>External Plugins<a class=headerlink href=#external-plugins title="Permanent link">¶</a></h5> <ul> <li><strong>Architecture</strong>: Standalone MCP servers communicating via protocol</li> <li><strong>Language</strong>: Any language (Python, TypeScript, Go, Rust, etc.)</li> <li><strong>Performance</strong>: 10-100ms latency depending on network and service</li> <li><strong>Use Cases</strong>: AI service integration, complex processing, external tool orchestration</li> </ul> <h4 id=plugin-development-commands>Plugin Development Commands<a class=headerlink href=#plugin-development-commands title="Permanent link">¶</a></h4> <p>The <code>mcpplugins</code> CLI tool provides comprehensive lifecycle management:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1># Create new plugin from template</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>mcpplugins<span class=w> </span>bootstrap<span class=w> </span>--destination<span class=w> </span>./my-security-plugin
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=c1># Plugin development workflow</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=nb>cd</span><span class=w> </span>./my-security-plugin
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>cp<span class=w> </span>.env.template<span class=w> </span>.env
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>make<span class=w> </span>install-dev<span class=w>                 </span><span class=c1># Install dependencies</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>make<span class=w> </span><span class=nb>test</span><span class=w>                        </span><span class=c1># Run tests</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>make<span class=w> </span>build<span class=w>                       </span><span class=c1># Build container (external plugins)</span>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>make<span class=w> </span>start<span class=w>                       </span><span class=c1># Start development server</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=c1># Verify external plugin MCP endpoint</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>npx<span class=w> </span>@modelcontextprotocol/inspector
</span></code></pre></div> <h4 id=gateway-integration-process>Gateway Integration Process<a class=headerlink href=#gateway-integration-process title="Permanent link">¶</a></h4> <p>External plugins integrate with the gateway through standardized configuration:</p> <p><strong>Plugin Server Configuration:</strong> </p><div class="language-yaml highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># resources/plugins/config.yaml (in plugin project)</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=nt>plugins</span><span class=p>:</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>  </span><span class=c1># TypeScript/Node.js plugin</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"OpenAIModerationTS"</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STREAMABLEHTTP"</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>"http://nodejs-plugin:3000/mcp"</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=w>      </span><span class=c1># tls:</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=w>      </span><span class=c1>#   ca_bundle: /app/certs/plugins/ca.crt</span>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=w>      </span><span class=c1>#   client_cert: /app/certs/plugins/gateway-client.pem</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>  </span><span class=c1># Go plugin</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"HighPerformanceFilter"</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STDIO"</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=w>      </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=s>"/opt/plugins/go-filter"</span>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=w>  </span><span class=c1># Rust plugin</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"CryptoValidator"</span>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STREAMABLEHTTP"</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>"http://rust-plugin:8080/mcp"</span>
</span><span id=__span-16-27><a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=w>      </span><span class=c1># tls:</span>
</span><span id=__span-16-28><a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=w>      </span><span class=c1>#   verify: true</span>
</span><span id=__span-16-29><a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>
</span><span id=__span-16-30><a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class="l l-Scalar l-Scalar-Plain">Gateway-wide defaults for these TLS options can be supplied via the</span>
</span><span id=__span-16-31><a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=err>`</span><span class="l l-Scalar l-Scalar-Plain">PLUGINS_MTLS_*` environment variables when you want every external</span>
</span><span id=__span-16-32><a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class="l l-Scalar l-Scalar-Plain">plugin to share the same client certificate and CA bundle.</span>
</span></code></pre></div><p></p> <p><strong>Gateway Configuration:</strong> </p><div class="language-yaml highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1># plugins/config.yaml (in gateway)</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=nt>plugins</span><span class=p>:</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"MySecurityFilter"</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>    </span><span class=nt>priority</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STREAMABLEHTTP"</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>"http://localhost:8000/mcp"</span>
</span></code></pre></div><p></p> <h3 id=mcp-protocol-integration>MCP Protocol Integration<a class=headerlink href=#mcp-protocol-integration title="Permanent link">¶</a></h3> <p>External plugins communicate via the Model Context Protocol (MCP), enabling language-agnostic plugin development.</p> <pre class=mermaid><code>---
config:
  mirrorActors: false
---
sequenceDiagram
    participant Gateway as MCP Gateway
    participant Client as External Plugin Client
    participant Server as Remote MCP Server
    participant Service as External AI Service

    Note over Gateway,Service: Plugin Initialization
    Gateway-&gt;&gt;Client: Initialize External Plugin
    Client-&gt;&gt;Server: MCP Connection (HTTP/WS/STDIO)
    Server--&gt;&gt;Client: Connection Established
    Client-&gt;&gt;Server: get_plugin_config(plugin_name)
    Server--&gt;&gt;Client: Plugin Configuration
    Client--&gt;&gt;Gateway: Plugin Ready

    Note over Gateway,Service: Request Processing
    Gateway-&gt;&gt;Client: tool_pre_invoke(payload, context)
    Client-&gt;&gt;Server: MCP Tool Call: tool_pre_invoke

    alt Self-Processing
        Server-&gt;&gt;Server: Process Internally
    else External Service Call
        Server-&gt;&gt;Service: API Call (OpenAI, LlamaGuard, etc.)
        Service--&gt;&gt;Server: Service Response
    end

    Server--&gt;&gt;Client: MCP Response
    Client--&gt;&gt;Gateway: PluginResult</code></pre> <h3 id=required-mcp-tools>Required MCP Tools<a class=headerlink href=#required-mcp-tools title="Permanent link">¶</a></h3> <p>External plugin servers must implement these standard MCP tools:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>REQUIRED_TOOLS</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>    <span class=s2>"get_plugin_config"</span><span class=p>,</span>      <span class=c1># Return plugin configuration metadata</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>    <span class=s2>"prompt_pre_fetch"</span><span class=p>,</span>       <span class=c1># Process prompt before template rendering</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=s2>"prompt_post_fetch"</span><span class=p>,</span>      <span class=c1># Process prompt after template rendering</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=s2>"tool_pre_invoke"</span><span class=p>,</span>        <span class=c1># Process tool call before execution</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=s2>"tool_post_invoke"</span><span class=p>,</span>       <span class=c1># Process tool result after execution</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>    <span class=s2>"resource_pre_fetch"</span><span class=p>,</span>     <span class=c1># Process resource request before fetching</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a>    <span class=s2>"resource_post_fetch"</span><span class=p>,</span>    <span class=c1># Process resource content after fetching</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=p>]</span>
</span></code></pre></div> <h3 id=external-plugin-configuration>External Plugin Configuration<a class=headerlink href=#external-plugin-configuration title="Permanent link">¶</a></h3> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=nt>plugins</span><span class=p>:</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"OpenAIModerationPlugin"</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span><span class=w>                    </span><span class=c1># Indicates external MCP server</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s>"OpenAI</span><span class=nv> </span><span class=s>Content</span><span class=nv> </span><span class=s>Moderation"</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s>"1.0.0"</span>
</span><span id=__span-19-7><a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>    </span><span class=nt>hooks</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>"tool_pre_invoke"</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>"prompt_pre_fetch"</span><span class="p p-Indicator">]</span>
</span><span id=__span-19-8><a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>    </span><span class=nt>mode</span><span class=p>:</span><span class=w> </span><span class=s>"enforce"</span>
</span><span id=__span-19-9><a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>    </span><span class=nt>priority</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span id=__span-19-10><a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-19-11><a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STREAMABLEHTTP"</span><span class=w>          </span><span class=c1># Transport protocol</span>
</span><span id=__span-19-12><a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>"http://openai-plugin:3000/mcp"</span><span class=w>  </span><span class=c1># Server URL</span>
</span><span id=__span-19-13><a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>      </span><span class=c1># Optional authentication</span>
</span><span id=__span-19-14><a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>      </span><span class=nt>auth</span><span class=p>:</span>
</span><span id=__span-19-15><a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=s>"bearer"</span>
</span><span id=__span-19-16><a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=w>        </span><span class=nt>token</span><span class=p>:</span><span class=w> </span><span class=s>"${OPENAI_API_KEY}"</span>
</span></code></pre></div> <h3 id=external-plugin-example-typescript>External Plugin Example (TypeScript)<a class=headerlink href=#external-plugin-example-typescript title="Permanent link">¶</a></h3> <div class="language-typescript highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1>// TypeScript/Node.js external plugin example</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>MCPServer</span><span class=p>,</span><span class=w> </span><span class=nx>Tool</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s1>'@modelcontextprotocol/sdk'</span><span class=p>;</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=k>import</span><span class=w> </span><span class=nx>OpenAI</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s1>'openai'</span><span class=p>;</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=kd>class</span><span class=w> </span><span class=nx>OpenAIModerationPlugin</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-6><a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=w>  </span><span class=k>private</span><span class=w> </span><span class=nx>openai</span><span class=o>:</span><span class=w> </span><span class=kt>OpenAI</span><span class=p>;</span>
</span><span id=__span-20-7><a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a>
</span><span id=__span-20-8><a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=w>  </span><span class=kr>constructor</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-9><a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=nx>openai</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>OpenAI</span><span class=p>({</span>
</span><span id=__span-20-10><a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=w>      </span><span class=nx>apiKey</span><span class=o>:</span><span class=w> </span><span class=kt>process.env.OPENAI_API_KEY</span>
</span><span id=__span-20-11><a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=w>    </span><span class=p>});</span>
</span><span id=__span-20-12><a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-20-13><a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a>
</span><span id=__span-20-14><a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=w>  </span><span class=kd>@Tool</span><span class=p>(</span><span class=s1>'tool_pre_invoke'</span><span class=p>)</span>
</span><span id=__span-20-15><a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=w>  </span><span class=k>async</span><span class=w> </span><span class=nx>handleToolPreInvoke</span><span class=p>(</span><span class=nx>params</span><span class=o>:</span><span class=w> </span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-16><a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a><span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>payload</span><span class=p>,</span><span class=w> </span><span class=nx>context</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>params</span><span class=p>;</span>
</span><span id=__span-20-17><a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a>
</span><span id=__span-20-18><a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a><span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Object</span><span class=p>.</span><span class=nx>values</span><span class=p>(</span><span class=nx>payload</span><span class=p>.</span><span class=nx>args</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=p>{})</span>
</span><span id=__span-20-19><a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=w>      </span><span class=p>.</span><span class=nx>filter</span><span class=p>(</span><span class=nx>v</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=ow>typeof</span><span class=w> </span><span class=nx>v</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=s1>'string'</span><span class=p>)</span>
</span><span id=__span-20-20><a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=w>      </span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s1>' '</span><span class=p>);</span>
</span><span id=__span-20-21><a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a>
</span><span id=__span-20-22><a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>content</span><span class=p>.</span><span class=nx>trim</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-23><a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a><span class=w>      </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>continue_processing</span><span class=o>:</span><span class=w> </span><span class=kt>true</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-20-24><a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-20-25><a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a>
</span><span id=__span-20-26><a id=__codelineno-20-26 name=__codelineno-20-26 href=#__codelineno-20-26></a><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-27><a id=__codelineno-20-27 name=__codelineno-20-27 href=#__codelineno-20-27></a><span class=w>      </span><span class=kd>const</span><span class=w> </span><span class=nx>moderation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=nx>openai</span><span class=p>.</span><span class=nx>moderations</span><span class=p>.</span><span class=nx>create</span><span class=p>({</span>
</span><span id=__span-20-28><a id=__codelineno-20-28 name=__codelineno-20-28 href=#__codelineno-20-28></a><span class=w>        </span><span class=nx>input</span><span class=o>:</span><span class=w> </span><span class=kt>content</span><span class=p>,</span>
</span><span id=__span-20-29><a id=__codelineno-20-29 name=__codelineno-20-29 href=#__codelineno-20-29></a><span class=w>        </span><span class=nx>model</span><span class=o>:</span><span class=w> </span><span class=s1>'text-moderation-stable'</span>
</span><span id=__span-20-30><a id=__codelineno-20-30 name=__codelineno-20-30 href=#__codelineno-20-30></a><span class=w>      </span><span class=p>});</span>
</span><span id=__span-20-31><a id=__codelineno-20-31 name=__codelineno-20-31 href=#__codelineno-20-31></a>
</span><span id=__span-20-32><a id=__codelineno-20-32 name=__codelineno-20-32 href=#__codelineno-20-32></a><span class=w>      </span><span class=kd>const</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>moderation</span><span class=p>.</span><span class=nx>results</span><span class=p>[</span><span class=mf>0</span><span class=p>];</span>
</span><span id=__span-20-33><a id=__codelineno-20-33 name=__codelineno-20-33 href=#__codelineno-20-33></a>
</span><span id=__span-20-34><a id=__codelineno-20-34 name=__codelineno-20-34 href=#__codelineno-20-34></a><span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>result</span><span class=p>.</span><span class=nx>flagged</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-35><a id=__codelineno-20-35 name=__codelineno-20-35 href=#__codelineno-20-35></a><span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>flaggedCategories</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Object</span><span class=p>.</span><span class=nx>entries</span><span class=p>(</span><span class=nx>result</span><span class=p>.</span><span class=nx>categories</span><span class=p>)</span>
</span><span id=__span-20-36><a id=__codelineno-20-36 name=__codelineno-20-36 href=#__codelineno-20-36></a><span class=w>          </span><span class=p>.</span><span class=nx>filter</span><span class=p>(([</span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>flagged</span><span class=p>])</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>flagged</span><span class=p>)</span>
</span><span id=__span-20-37><a id=__codelineno-20-37 name=__codelineno-20-37 href=#__codelineno-20-37></a><span class=w>          </span><span class=p>.</span><span class=nx>map</span><span class=p>(([</span><span class=nx>category</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=p>])</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>category</span><span class=p>);</span>
</span><span id=__span-20-38><a id=__codelineno-20-38 name=__codelineno-20-38 href=#__codelineno-20-38></a>
</span><span id=__span-20-39><a id=__codelineno-20-39 name=__codelineno-20-39 href=#__codelineno-20-39></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-40><a id=__codelineno-20-40 name=__codelineno-20-40 href=#__codelineno-20-40></a><span class=w>          </span><span class=nx>continue_processing</span><span class=o>:</span><span class=w> </span><span class=kt>false</span><span class=p>,</span>
</span><span id=__span-20-41><a id=__codelineno-20-41 name=__codelineno-20-41 href=#__codelineno-20-41></a><span class=w>          </span><span class=nx>violation</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-42><a id=__codelineno-20-42 name=__codelineno-20-42 href=#__codelineno-20-42></a><span class=w>            </span><span class=nx>reason</span><span class=o>:</span><span class=w> </span><span class=s1>'Content policy violation'</span><span class=p>,</span>
</span><span id=__span-20-43><a id=__codelineno-20-43 name=__codelineno-20-43 href=#__codelineno-20-43></a><span class=w>            </span><span class=nx>description</span><span class=o>:</span><span class=w> </span><span class=sb>`OpenAI Moderation flagged: </span><span class=si>${</span><span class=nx>flaggedCategories</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s1>', '</span><span class=p>)</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span>
</span><span id=__span-20-44><a id=__codelineno-20-44 name=__codelineno-20-44 href=#__codelineno-20-44></a><span class=w>            </span><span class=nx>code</span><span class=o>:</span><span class=w> </span><span class=s1>'OPENAI_MODERATION_FLAGGED'</span><span class=p>,</span>
</span><span id=__span-20-45><a id=__codelineno-20-45 name=__codelineno-20-45 href=#__codelineno-20-45></a><span class=w>            </span><span class=nx>details</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-46><a id=__codelineno-20-46 name=__codelineno-20-46 href=#__codelineno-20-46></a><span class=w>              </span><span class=nx>categories</span><span class=o>:</span><span class=w> </span><span class=kt>result.categories</span><span class=p>,</span>
</span><span id=__span-20-47><a id=__codelineno-20-47 name=__codelineno-20-47 href=#__codelineno-20-47></a><span class=w>              </span><span class=nx>flagged_categories</span><span class=o>:</span><span class=w> </span><span class=kt>flaggedCategories</span>
</span><span id=__span-20-48><a id=__codelineno-20-48 name=__codelineno-20-48 href=#__codelineno-20-48></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-20-49><a id=__codelineno-20-49 name=__codelineno-20-49 href=#__codelineno-20-49></a><span class=w>          </span><span class=p>}</span>
</span><span id=__span-20-50><a id=__codelineno-20-50 name=__codelineno-20-50 href=#__codelineno-20-50></a><span class=w>        </span><span class=p>};</span>
</span><span id=__span-20-51><a id=__codelineno-20-51 name=__codelineno-20-51 href=#__codelineno-20-51></a><span class=w>      </span><span class=p>}</span>
</span><span id=__span-20-52><a id=__codelineno-20-52 name=__codelineno-20-52 href=#__codelineno-20-52></a>
</span><span id=__span-20-53><a id=__codelineno-20-53 name=__codelineno-20-53 href=#__codelineno-20-53></a><span class=w>      </span><span class=k>return</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-54><a id=__codelineno-20-54 name=__codelineno-20-54 href=#__codelineno-20-54></a><span class=w>        </span><span class=nx>continue_processing</span><span class=o>:</span><span class=w> </span><span class=kt>true</span><span class=p>,</span>
</span><span id=__span-20-55><a id=__codelineno-20-55 name=__codelineno-20-55 href=#__codelineno-20-55></a><span class=w>        </span><span class=nx>metadata</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-56><a id=__codelineno-20-56 name=__codelineno-20-56 href=#__codelineno-20-56></a><span class=w>          </span><span class=nx>openai_moderation_score</span><span class=o>:</span><span class=w> </span><span class=kt>Math.max</span><span class=p>(...</span><span class=nb>Object</span><span class=p>.</span><span class=nx>values</span><span class=p>(</span><span class=nx>result</span><span class=p>.</span><span class=nx>category_scores</span><span class=p>))</span>
</span><span id=__span-20-57><a id=__codelineno-20-57 name=__codelineno-20-57 href=#__codelineno-20-57></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-20-58><a id=__codelineno-20-58 name=__codelineno-20-58 href=#__codelineno-20-58></a><span class=w>      </span><span class=p>};</span>
</span><span id=__span-20-59><a id=__codelineno-20-59 name=__codelineno-20-59 href=#__codelineno-20-59></a>
</span><span id=__span-20-60><a id=__codelineno-20-60 name=__codelineno-20-60 href=#__codelineno-20-60></a><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-61><a id=__codelineno-20-61 name=__codelineno-20-61 href=#__codelineno-20-61></a><span class=w>      </span><span class=k>return</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-62><a id=__codelineno-20-62 name=__codelineno-20-62 href=#__codelineno-20-62></a><span class=w>        </span><span class=nx>continue_processing</span><span class=o>:</span><span class=w> </span><span class=kt>true</span><span class=p>,</span>
</span><span id=__span-20-63><a id=__codelineno-20-63 name=__codelineno-20-63 href=#__codelineno-20-63></a><span class=w>        </span><span class=nx>metadata</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>moderation_error</span><span class=o>:</span><span class=w> </span><span class=kt>error.message</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-20-64><a id=__codelineno-20-64 name=__codelineno-20-64 href=#__codelineno-20-64></a><span class=w>      </span><span class=p>};</span>
</span><span id=__span-20-65><a id=__codelineno-20-65 name=__codelineno-20-65 href=#__codelineno-20-65></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-20-66><a id=__codelineno-20-66 name=__codelineno-20-66 href=#__codelineno-20-66></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-20-67><a id=__codelineno-20-67 name=__codelineno-20-67 href=#__codelineno-20-67></a>
</span><span id=__span-20-68><a id=__codelineno-20-68 name=__codelineno-20-68 href=#__codelineno-20-68></a><span class=w>  </span><span class=kd>@Tool</span><span class=p>(</span><span class=s1>'get_plugin_config'</span><span class=p>)</span>
</span><span id=__span-20-69><a id=__codelineno-20-69 name=__codelineno-20-69 href=#__codelineno-20-69></a><span class=w>  </span><span class=k>async</span><span class=w> </span><span class=nx>getPluginConfig</span><span class=p>(</span><span class=nx>params</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-70><a id=__codelineno-20-70 name=__codelineno-20-70 href=#__codelineno-20-70></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-71><a id=__codelineno-20-71 name=__codelineno-20-71 href=#__codelineno-20-71></a><span class=w>      </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=kt>params.name</span><span class=p>,</span>
</span><span id=__span-20-72><a id=__codelineno-20-72 name=__codelineno-20-72 href=#__codelineno-20-72></a><span class=w>      </span><span class=nx>description</span><span class=o>:</span><span class=w> </span><span class=s1>'OpenAI Content Moderation'</span><span class=p>,</span>
</span><span id=__span-20-73><a id=__codelineno-20-73 name=__codelineno-20-73 href=#__codelineno-20-73></a><span class=w>      </span><span class=nx>version</span><span class=o>:</span><span class=w> </span><span class=s1>'1.0.0'</span><span class=p>,</span>
</span><span id=__span-20-74><a id=__codelineno-20-74 name=__codelineno-20-74 href=#__codelineno-20-74></a><span class=w>      </span><span class=nx>hooks</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>'tool_pre_invoke'</span><span class=p>,</span><span class=w> </span><span class=s1>'prompt_pre_fetch'</span><span class=p>],</span>
</span><span id=__span-20-75><a id=__codelineno-20-75 name=__codelineno-20-75 href=#__codelineno-20-75></a><span class=w>      </span><span class=nx>tags</span><span class=o>:</span><span class=w> </span><span class=p>[</span><span class=s1>'openai'</span><span class=p>,</span><span class=w> </span><span class=s1>'moderation'</span><span class=p>,</span><span class=w> </span><span class=s1>'content-safety'</span><span class=p>],</span>
</span><span id=__span-20-76><a id=__codelineno-20-76 name=__codelineno-20-76 href=#__codelineno-20-76></a><span class=w>      </span><span class=nx>mode</span><span class=o>:</span><span class=w> </span><span class=s1>'enforce'</span><span class=p>,</span>
</span><span id=__span-20-77><a id=__codelineno-20-77 name=__codelineno-20-77 href=#__codelineno-20-77></a><span class=w>      </span><span class=nx>priority</span><span class=o>:</span><span class=w> </span><span class=kt>30</span>
</span><span id=__span-20-78><a id=__codelineno-20-78 name=__codelineno-20-78 href=#__codelineno-20-78></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-20-79><a id=__codelineno-20-79 name=__codelineno-20-79 href=#__codelineno-20-79></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-20-80><a id=__codelineno-20-80 name=__codelineno-20-80 href=#__codelineno-20-80></a><span class=p>}</span>
</span><span id=__span-20-81><a id=__codelineno-20-81 name=__codelineno-20-81 href=#__codelineno-20-81></a>
</span><span id=__span-20-82><a id=__codelineno-20-82 name=__codelineno-20-82 href=#__codelineno-20-82></a><span class=kd>const</span><span class=w> </span><span class=nx>server</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>MCPServer</span><span class=p>();</span>
</span><span id=__span-20-83><a id=__codelineno-20-83 name=__codelineno-20-83 href=#__codelineno-20-83></a><span class=kd>const</span><span class=w> </span><span class=nx>plugin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>OpenAIModerationPlugin</span><span class=p>();</span>
</span><span id=__span-20-84><a id=__codelineno-20-84 name=__codelineno-20-84 href=#__codelineno-20-84></a><span class=nx>server</span><span class=p>.</span><span class=nx>registerPlugin</span><span class=p>(</span><span class=nx>plugin</span><span class=p>);</span>
</span><span id=__span-20-85><a id=__codelineno-20-85 name=__codelineno-20-85 href=#__codelineno-20-85></a><span class=nx>server</span><span class=p>.</span><span class=nx>listen</span><span class=p>({</span><span class=w> </span><span class=nx>transport</span><span class=o>:</span><span class=w> </span><span class=s1>'stdio'</span><span class=w> </span><span class=p>});</span>
</span></code></pre></div> <h2 id=security-and-protection>Security and Protection<a class=headerlink href=#security-and-protection title="Permanent link">¶</a></h2> <h3 id=timeout-protection>Timeout Protection<a class=headerlink href=#timeout-protection title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=k>class</span><span class=w> </span><span class=nc>PluginExecutor</span><span class=p>:</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>_execute_with_timeout</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>plugin</span><span class=p>:</span> <span class=n>PluginRef</span><span class=p>,</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>                                   <span class=n>plugin_run</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>T</span><span class=p>,</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>                                   <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PluginResult</span><span class=p>[</span><span class=n>T</span><span class=p>]:</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=w>        </span><span class=sd>"""Execute plugin with timeout protection"""</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>        <span class=k>return</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>wait_for</span><span class=p>(</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>            <span class=n>plugin_run</span><span class=p>(</span><span class=n>plugin</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=n>context</span><span class=p>),</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>            <span class=n>timeout</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>timeout</span>  <span class=c1># Default 30 seconds</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>        <span class=p>)</span>
</span></code></pre></div> <h3 id=payload-size-validation>Payload Size Validation<a class=headerlink href=#payload-size-validation title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>def</span><span class=w> </span><span class=nf>_validate_payload_size</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=w>    </span><span class=sd>"""Validate that payload doesn't exceed size limits"""</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>    <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=s2>"args"</span><span class=p>)</span> <span class=ow>and</span> <span class=n>payload</span><span class=o>.</span><span class=n>args</span><span class=p>:</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>        <span class=n>total_size</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>v</span><span class=p>))</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>payload</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>        <span class=k>if</span> <span class=n>total_size</span> <span class=o>&gt;</span> <span class=n>MAX_PAYLOAD_SIZE</span><span class=p>:</span>  <span class=c1># 1MB limit</span>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>            <span class=k>raise</span> <span class=n>PayloadSizeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Payload size </span><span class=si>{</span><span class=n>total_size</span><span class=si>}</span><span class=s2> exceeds limit"</span><span class=p>)</span>
</span></code></pre></div> <h3 id=error-isolation>Error Isolation<a class=headerlink href=#error-isolation title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>execute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>plugins</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=n>PluginRef</span><span class=p>],</span> <span class=o>...</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>PluginResult</span><span class=p>[</span><span class=n>T</span><span class=p>],</span> <span class=n>PluginContextTable</span><span class=p>]:</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>    <span class=k>for</span> <span class=n>plugin</span> <span class=ow>in</span> <span class=n>plugins</span><span class=p>:</span>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>            <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_execute_with_timeout</span><span class=p>(</span><span class=n>plugin</span><span class=p>,</span> <span class=o>...</span><span class=p>)</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a>            <span class=c1># Process result...</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>
</span><span id=__span-23-7><a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a>        <span class=k>except</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>TimeoutError</span><span class=p>:</span>
</span><span id=__span-23-8><a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Plugin </span><span class=si>{</span><span class=n>plugin</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> timed out after </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>timeout</span><span class=si>}</span><span class=s2>s"</span><span class=p>)</span>
</span><span id=__span-23-9><a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a>            <span class=k>if</span> <span class=n>plugin</span><span class=o>.</span><span class=n>mode</span> <span class=o>==</span> <span class=n>PluginMode</span><span class=o>.</span><span class=n>ENFORCE</span><span class=p>:</span>
</span><span id=__span-23-10><a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>                <span class=k>return</span> <span class=n>create_timeout_violation</span><span class=p>()</span>
</span><span id=__span-23-11><a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a>
</span><span id=__span-23-12><a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-23-13><a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Plugin </span><span class=si>{</span><span class=n>plugin</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>exc_info</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-23-14><a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>            <span class=k>if</span> <span class=n>plugin</span><span class=o>.</span><span class=n>mode</span> <span class=o>==</span> <span class=n>PluginMode</span><span class=o>.</span><span class=n>ENFORCE</span><span class=p>:</span>
</span><span id=__span-23-15><a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>                <span class=k>return</span> <span class=n>create_error_violation</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span><span id=__span-23-16><a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a>            <span class=c1># In permissive mode, continue with next plugin</span>
</span></code></pre></div> <h3 id=security-capabilities>Security Capabilities<a class=headerlink href=#security-capabilities title="Permanent link">¶</a></h3> <p>Future versions will support a security capability system for plugins. Through the configuration manifest, the following set of capabilities can be defined:</p> <ul> <li>hook:invoke:<hook-name> — allow executing specific hook(s)</hook-name></li> <li>read:context / write:context — access to plugin context/state</li> <li>network:egress / network:ingress — outbound/inbound network access (with host/port scopes)</li> <li>secrets:get — fetch secrets from vault (scoped)</li> <li>filesystem:read / filesystem:write — filesystem access (scoped)</li> <li>exec:process — ability to spawn subprocesses</li> <li>metrics:emit — emit metrics/traces</li> </ul> <p>An example manifest:</p> <div class="language-YAML highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pii-filter</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=nt>framework_compatibility</span><span class=p>:</span><span class=w> </span><span class=s>"mcp-plugin-framework&gt;=1.0.0,&lt;2.0.0"</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=nn>...</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=nt>hooks</span><span class=p>:</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">prompt_pre_fetch</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=nt>capabilities</span><span class=p>:</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">hook:invoke:prompt_pre_fetch</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">read:context</span>
</span></code></pre></div> <h3 id=plugin-signing>Plugin Signing<a class=headerlink href=#plugin-signing title="Permanent link">¶</a></h3> <p>Future versions will support cryptographic signing of plugins for supply chain security (e.g., leveraging Sigstore signing infrastructure).</p> <p>An example manifest:</p> <div class="language-YAML highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pii-filter</span>
</span><span id=__span-25-2><a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0</span>
</span><span id=__span-25-3><a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=nt>framework_compatibility</span><span class=p>:</span><span class=w> </span><span class=s>"mcp-plugin-framework&gt;=1.0.0,&lt;2.0.0"</span>
</span><span id=__span-25-4><a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=nn>...</span>
</span><span id=__span-25-5><a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=nt>signing</span><span class=p>:</span>
</span><span id=__span-25-6><a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=w>  </span><span class=nt>algorithm</span><span class=p>:</span><span class=w> </span><span class=s>"ECDSA"</span>
</span><span id=__span-25-7><a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=w>  </span><span class=nt>signature</span><span class=p>:</span><span class=w> </span><span class=s>"..."</span>
</span></code></pre></div> <h2 id=performance-considerations>Performance Considerations<a class=headerlink href=#performance-considerations title="Permanent link">¶</a></h2> <h3 id=resource-management>Resource Management<a class=headerlink href=#resource-management title="Permanent link">¶</a></h3> <ul> <li><strong>Memory Usage:</strong> Base framework overhead, scales linearly with active plugins</li> <li><strong>CPU Impact:</strong> Native plugins add negligible latency per hook</li> <li><strong>Context Cleanup:</strong> Automatic cleanup every 5 minutes, contexts expire after 1 hour</li> <li><strong>Timeout Protection:</strong> Default 30-second timeout per plugin prevents hangs</li> </ul> <h3 id=optimization-strategies>Optimization Strategies<a class=headerlink href=#optimization-strategies title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-26-1><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=c1># Configuration constants for performance tuning</span>
</span><span id=__span-26-2><a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=n>DEFAULT_PLUGIN_TIMEOUT</span> <span class=o>=</span> <span class=mi>30</span>      <span class=c1># seconds</span>
</span><span id=__span-26-3><a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=n>MAX_PAYLOAD_SIZE</span> <span class=o>=</span> <span class=mi>1_000_000</span>     <span class=c1># 1MB</span>
</span><span id=__span-26-4><a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=n>CONTEXT_CLEANUP_INTERVAL</span> <span class=o>=</span> <span class=mi>300</span>   <span class=c1># 5 minutes</span>
</span><span id=__span-26-5><a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=n>CONTEXT_MAX_AGE</span> <span class=o>=</span> <span class=mi>3600</span>          <span class=c1># 1 hour</span>
</span><span id=__span-26-6><a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>
</span><span id=__span-26-7><a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=c1># Parallel execution within priority bands (future enhancement)</span>
</span><span id=__span-26-8><a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=k>class</span><span class=w> </span><span class=nc>PluginSettings</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-26-9><a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>    <span class=n>parallel_execution_within_band</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>  <span class=c1># Execute same-priority plugins in parallel</span>
</span><span id=__span-26-10><a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>    <span class=n>plugin_timeout</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>30</span>                      <span class=c1># Per-plugin timeout</span>
</span><span id=__span-26-11><a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a>    <span class=n>fail_on_plugin_error</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>           <span class=c1># Continue on plugin failures</span>
</span></code></pre></div> <h2 id=development-guidelines>Development Guidelines<a class=headerlink href=#development-guidelines title="Permanent link">¶</a></h2> <h3 id=plugin-development-workflow>Plugin Development Workflow<a class=headerlink href=#plugin-development-workflow title="Permanent link">¶</a></h3> <ol> <li><strong>Create Plugin Class:</strong> Extend <code>Plugin</code> base class</li> <li><strong>Implement Hook Methods:</strong> Override required hook methods</li> <li><strong>Define Configuration Schema:</strong> Create plugin-specific config structure</li> <li><strong>Add Plugin Manifest:</strong> Create <code>plugin-manifest.yaml</code> with metadata</li> <li><strong>Write Tests:</strong> Comprehensive unit and integration tests</li> <li><strong>Register Plugin:</strong> Add to <code>plugins/config.yaml</code></li> </ol> <h3 id=built-in-plugin-examples>Built-in Plugin Examples<a class=headerlink href=#built-in-plugin-examples title="Permanent link">¶</a></h3> <h4 id=pii-filter-plugin-native>PII Filter Plugin (Native)<a class=headerlink href=#pii-filter-plugin-native title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-27-1><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=k>class</span><span class=w> </span><span class=nc>PIIFilterPlugin</span><span class=p>(</span><span class=n>Plugin</span><span class=p>):</span>
</span><span id=__span-27-2><a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=w>    </span><span class=sd>"""Detects and masks Personally Identifiable Information"""</span>
</span><span id=__span-27-3><a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>
</span><span id=__span-27-4><a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>prompt_pre_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>PromptPrehookPayload</span><span class=p>,</span>
</span><span id=__span-27-5><a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>                              <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PromptPrehookResult</span><span class=p>:</span>
</span><span id=__span-27-6><a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>        <span class=n>pii_patterns</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_pii_patterns</span><span class=p>()</span>
</span><span id=__span-27-7><a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>        <span class=n>violations</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-27-8><a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>
</span><span id=__span-27-9><a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>        <span class=k>for</span> <span class=n>arg_name</span><span class=p>,</span> <span class=n>arg_value</span> <span class=ow>in</span> <span class=n>payload</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-27-10><a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>            <span class=n>detected_pii</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_scan_for_pii</span><span class=p>(</span><span class=n>arg_value</span><span class=p>,</span> <span class=n>pii_patterns</span><span class=p>)</span>
</span><span id=__span-27-11><a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>            <span class=k>if</span> <span class=n>detected_pii</span><span class=p>:</span>
</span><span id=__span-27-12><a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"block_on_detection"</span><span class=p>,</span> <span class=kc>False</span><span class=p>):</span>
</span><span id=__span-27-13><a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a>                    <span class=n>violation</span> <span class=o>=</span> <span class=n>PluginViolation</span><span class=p>(</span>
</span><span id=__span-27-14><a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a>                        <span class=n>reason</span><span class=o>=</span><span class=s2>"PII detected in prompt arguments"</span><span class=p>,</span>
</span><span id=__span-27-15><a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a>                        <span class=n>description</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Found </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>detected_pii</span><span class=p>)</span><span class=si>}</span><span class=s2> PII items in </span><span class=si>{</span><span class=n>arg_name</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-27-16><a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a>                        <span class=n>code</span><span class=o>=</span><span class=s2>"PII_DETECTED"</span><span class=p>,</span>
</span><span id=__span-27-17><a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a>                        <span class=n>details</span><span class=o>=</span><span class=p>{</span><span class=s2>"field"</span><span class=p>:</span> <span class=n>arg_name</span><span class=p>,</span> <span class=s2>"types"</span><span class=p>:</span> <span class=n>detected_pii</span><span class=p>}</span>
</span><span id=__span-27-18><a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a>                    <span class=p>)</span>
</span><span id=__span-27-19><a id=__codelineno-27-19 name=__codelineno-27-19 href=#__codelineno-27-19></a>                    <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span>
</span><span id=__span-27-20><a id=__codelineno-27-20 name=__codelineno-27-20 href=#__codelineno-27-20></a>                        <span class=n>continue_processing</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-27-21><a id=__codelineno-27-21 name=__codelineno-27-21 href=#__codelineno-27-21></a>                        <span class=n>violation</span><span class=o>=</span><span class=n>violation</span>
</span><span id=__span-27-22><a id=__codelineno-27-22 name=__codelineno-27-22 href=#__codelineno-27-22></a>                    <span class=p>)</span>
</span><span id=__span-27-23><a id=__codelineno-27-23 name=__codelineno-27-23 href=#__codelineno-27-23></a>
</span><span id=__span-27-24><a id=__codelineno-27-24 name=__codelineno-27-24 href=#__codelineno-27-24></a>                <span class=c1># Apply masking</span>
</span><span id=__span-27-25><a id=__codelineno-27-25 name=__codelineno-27-25 href=#__codelineno-27-25></a>                <span class=n>masked_value</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_masking</span><span class=p>(</span><span class=n>arg_value</span><span class=p>,</span> <span class=n>detected_pii</span><span class=p>)</span>
</span><span id=__span-27-26><a id=__codelineno-27-26 name=__codelineno-27-26 href=#__codelineno-27-26></a>                <span class=n>payload</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=n>arg_name</span><span class=p>]</span> <span class=o>=</span> <span class=n>masked_value</span>
</span><span id=__span-27-27><a id=__codelineno-27-27 name=__codelineno-27-27 href=#__codelineno-27-27></a>
</span><span id=__span-27-28><a id=__codelineno-27-28 name=__codelineno-27-28 href=#__codelineno-27-28></a>        <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span>
</span><span id=__span-27-29><a id=__codelineno-27-29 name=__codelineno-27-29 href=#__codelineno-27-29></a>            <span class=n>continue_processing</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-27-30><a id=__codelineno-27-30 name=__codelineno-27-30 href=#__codelineno-27-30></a>            <span class=n>modified_payload</span><span class=o>=</span><span class=n>payload</span><span class=p>,</span>
</span><span id=__span-27-31><a id=__codelineno-27-31 name=__codelineno-27-31 href=#__codelineno-27-31></a>            <span class=n>metadata</span><span class=o>=</span><span class=p>{</span><span class=s2>"pii_detections"</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>violations</span><span class=p>)}</span>
</span><span id=__span-27-32><a id=__codelineno-27-32 name=__codelineno-27-32 href=#__codelineno-27-32></a>        <span class=p>)</span>
</span></code></pre></div> <h4 id=resource-filter-plugin-security>Resource Filter Plugin (Security)<a class=headerlink href=#resource-filter-plugin-security title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-28-1><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=k>class</span><span class=w> </span><span class=nc>ResourceFilterPlugin</span><span class=p>(</span><span class=n>Plugin</span><span class=p>):</span>
</span><span id=__span-28-2><a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=w>    </span><span class=sd>"""Validates and filters resource requests"""</span>
</span><span id=__span-28-3><a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>
</span><span id=__span-28-4><a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>resource_pre_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ResourcePreFetchPayload</span><span class=p>,</span>
</span><span id=__span-28-5><a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>                                <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ResourcePreFetchResult</span><span class=p>:</span>
</span><span id=__span-28-6><a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>        <span class=n>uri_parts</span> <span class=o>=</span> <span class=n>urlparse</span><span class=p>(</span><span class=n>payload</span><span class=o>.</span><span class=n>uri</span><span class=p>)</span>
</span><span id=__span-28-7><a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>
</span><span id=__span-28-8><a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>        <span class=c1># Protocol validation</span>
</span><span id=__span-28-9><a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>        <span class=n>allowed_protocols</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"allowed_protocols"</span><span class=p>,</span> <span class=p>[</span><span class=s2>"http"</span><span class=p>,</span> <span class=s2>"https"</span><span class=p>])</span>
</span><span id=__span-28-10><a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>        <span class=k>if</span> <span class=n>uri_parts</span><span class=o>.</span><span class=n>scheme</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>allowed_protocols</span><span class=p>:</span>
</span><span id=__span-28-11><a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>            <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span>
</span><span id=__span-28-12><a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>                <span class=n>continue_processing</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-28-13><a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>                <span class=n>violation</span><span class=o>=</span><span class=n>PluginViolation</span><span class=p>(</span>
</span><span id=__span-28-14><a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a>                    <span class=n>reason</span><span class=o>=</span><span class=s2>"Blocked protocol"</span><span class=p>,</span>
</span><span id=__span-28-15><a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a>                    <span class=n>description</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Protocol '</span><span class=si>{</span><span class=n>uri_parts</span><span class=o>.</span><span class=n>scheme</span><span class=si>}</span><span class=s2>' not in allowed list"</span><span class=p>,</span>
</span><span id=__span-28-16><a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>                    <span class=n>code</span><span class=o>=</span><span class=s2>"PROTOCOL_BLOCKED"</span><span class=p>,</span>
</span><span id=__span-28-17><a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>                    <span class=n>details</span><span class=o>=</span><span class=p>{</span><span class=s2>"protocol"</span><span class=p>:</span> <span class=n>uri_parts</span><span class=o>.</span><span class=n>scheme</span><span class=p>,</span> <span class=s2>"uri"</span><span class=p>:</span> <span class=n>payload</span><span class=o>.</span><span class=n>uri</span><span class=p>}</span>
</span><span id=__span-28-18><a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>                <span class=p>)</span>
</span><span id=__span-28-19><a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>            <span class=p>)</span>
</span><span id=__span-28-20><a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>
</span><span id=__span-28-21><a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>        <span class=c1># Domain validation</span>
</span><span id=__span-28-22><a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>        <span class=n>blocked_domains</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"blocked_domains"</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-28-23><a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a>        <span class=k>if</span> <span class=n>uri_parts</span><span class=o>.</span><span class=n>netloc</span> <span class=ow>in</span> <span class=n>blocked_domains</span><span class=p>:</span>
</span><span id=__span-28-24><a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a>            <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span>
</span><span id=__span-28-25><a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a>                <span class=n>continue_processing</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-28-26><a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a>                <span class=n>violation</span><span class=o>=</span><span class=n>PluginViolation</span><span class=p>(</span>
</span><span id=__span-28-27><a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a>                    <span class=n>reason</span><span class=o>=</span><span class=s2>"Blocked domain"</span><span class=p>,</span>
</span><span id=__span-28-28><a id=__codelineno-28-28 name=__codelineno-28-28 href=#__codelineno-28-28></a>                    <span class=n>description</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Domain '</span><span class=si>{</span><span class=n>uri_parts</span><span class=o>.</span><span class=n>netloc</span><span class=si>}</span><span class=s2>' is in blocked list"</span><span class=p>,</span>
</span><span id=__span-28-29><a id=__codelineno-28-29 name=__codelineno-28-29 href=#__codelineno-28-29></a>                    <span class=n>code</span><span class=o>=</span><span class=s2>"DOMAIN_BLOCKED"</span><span class=p>,</span>
</span><span id=__span-28-30><a id=__codelineno-28-30 name=__codelineno-28-30 href=#__codelineno-28-30></a>                    <span class=n>details</span><span class=o>=</span><span class=p>{</span><span class=s2>"domain"</span><span class=p>:</span> <span class=n>uri_parts</span><span class=o>.</span><span class=n>netloc</span><span class=p>}</span>
</span><span id=__span-28-31><a id=__codelineno-28-31 name=__codelineno-28-31 href=#__codelineno-28-31></a>                <span class=p>)</span>
</span><span id=__span-28-32><a id=__codelineno-28-32 name=__codelineno-28-32 href=#__codelineno-28-32></a>            <span class=p>)</span>
</span><span id=__span-28-33><a id=__codelineno-28-33 name=__codelineno-28-33 href=#__codelineno-28-33></a>
</span><span id=__span-28-34><a id=__codelineno-28-34 name=__codelineno-28-34 href=#__codelineno-28-34></a>        <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span><span class=n>continue_processing</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-28-35><a id=__codelineno-28-35 name=__codelineno-28-35 href=#__codelineno-28-35></a>
</span><span id=__span-28-36><a id=__codelineno-28-36 name=__codelineno-28-36 href=#__codelineno-28-36></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>resource_post_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payload</span><span class=p>:</span> <span class=n>ResourcePostFetchPayload</span><span class=p>,</span>
</span><span id=__span-28-37><a id=__codelineno-28-37 name=__codelineno-28-37 href=#__codelineno-28-37></a>                                 <span class=n>context</span><span class=p>:</span> <span class=n>PluginContext</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ResourcePostFetchResult</span><span class=p>:</span>
</span><span id=__span-28-38><a id=__codelineno-28-38 name=__codelineno-28-38 href=#__codelineno-28-38></a>        <span class=n>content</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>content</span>
</span><span id=__span-28-39><a id=__codelineno-28-39 name=__codelineno-28-39 href=#__codelineno-28-39></a>
</span><span id=__span-28-40><a id=__codelineno-28-40 name=__codelineno-28-40 href=#__codelineno-28-40></a>        <span class=c1># Size validation</span>
</span><span id=__span-28-41><a id=__codelineno-28-41 name=__codelineno-28-41 href=#__codelineno-28-41></a>        <span class=n>max_size</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"max_content_size"</span><span class=p>,</span> <span class=mi>1048576</span><span class=p>)</span>  <span class=c1># 1MB default</span>
</span><span id=__span-28-42><a id=__codelineno-28-42 name=__codelineno-28-42 href=#__codelineno-28-42></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=s1>'text'</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=o>.</span><span class=n>text</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>max_size</span><span class=p>:</span>
</span><span id=__span-28-43><a id=__codelineno-28-43 name=__codelineno-28-43 href=#__codelineno-28-43></a>            <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span>
</span><span id=__span-28-44><a id=__codelineno-28-44 name=__codelineno-28-44 href=#__codelineno-28-44></a>                <span class=n>continue_processing</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-28-45><a id=__codelineno-28-45 name=__codelineno-28-45 href=#__codelineno-28-45></a>                <span class=n>violation</span><span class=o>=</span><span class=n>PluginViolation</span><span class=p>(</span>
</span><span id=__span-28-46><a id=__codelineno-28-46 name=__codelineno-28-46 href=#__codelineno-28-46></a>                    <span class=n>reason</span><span class=o>=</span><span class=s2>"Content too large"</span><span class=p>,</span>
</span><span id=__span-28-47><a id=__codelineno-28-47 name=__codelineno-28-47 href=#__codelineno-28-47></a>                    <span class=n>description</span><span class=o>=</span><span class=sa>f</span><span class=s2>"Content size </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=o>.</span><span class=n>text</span><span class=p>)</span><span class=si>}</span><span class=s2> exceeds limit </span><span class=si>{</span><span class=n>max_size</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span>
</span><span id=__span-28-48><a id=__codelineno-28-48 name=__codelineno-28-48 href=#__codelineno-28-48></a>                    <span class=n>code</span><span class=o>=</span><span class=s2>"CONTENT_SIZE_EXCEEDED"</span><span class=p>,</span>
</span><span id=__span-28-49><a id=__codelineno-28-49 name=__codelineno-28-49 href=#__codelineno-28-49></a>                    <span class=n>details</span><span class=o>=</span><span class=p>{</span><span class=s2>"size"</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>content</span><span class=o>.</span><span class=n>text</span><span class=p>),</span> <span class=s2>"limit"</span><span class=p>:</span> <span class=n>max_size</span><span class=p>}</span>
</span><span id=__span-28-50><a id=__codelineno-28-50 name=__codelineno-28-50 href=#__codelineno-28-50></a>                <span class=p>)</span>
</span><span id=__span-28-51><a id=__codelineno-28-51 name=__codelineno-28-51 href=#__codelineno-28-51></a>            <span class=p>)</span>
</span><span id=__span-28-52><a id=__codelineno-28-52 name=__codelineno-28-52 href=#__codelineno-28-52></a>
</span><span id=__span-28-53><a id=__codelineno-28-53 name=__codelineno-28-53 href=#__codelineno-28-53></a>        <span class=c1># Content filtering</span>
</span><span id=__span-28-54><a id=__codelineno-28-54 name=__codelineno-28-54 href=#__codelineno-28-54></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=s1>'text'</span><span class=p>):</span>
</span><span id=__span-28-55><a id=__codelineno-28-55 name=__codelineno-28-55 href=#__codelineno-28-55></a>            <span class=n>filtered_text</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_content_filters</span><span class=p>(</span><span class=n>content</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span><span id=__span-28-56><a id=__codelineno-28-56 name=__codelineno-28-56 href=#__codelineno-28-56></a>            <span class=k>if</span> <span class=n>filtered_text</span> <span class=o>!=</span> <span class=n>content</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span><span id=__span-28-57><a id=__codelineno-28-57 name=__codelineno-28-57 href=#__codelineno-28-57></a>                <span class=n>content</span><span class=o>.</span><span class=n>text</span> <span class=o>=</span> <span class=n>filtered_text</span>
</span><span id=__span-28-58><a id=__codelineno-28-58 name=__codelineno-28-58 href=#__codelineno-28-58></a>                <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span>
</span><span id=__span-28-59><a id=__codelineno-28-59 name=__codelineno-28-59 href=#__codelineno-28-59></a>                    <span class=n>continue_processing</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span><span id=__span-28-60><a id=__codelineno-28-60 name=__codelineno-28-60 href=#__codelineno-28-60></a>                    <span class=n>modified_payload</span><span class=o>=</span><span class=n>payload</span><span class=p>,</span>
</span><span id=__span-28-61><a id=__codelineno-28-61 name=__codelineno-28-61 href=#__codelineno-28-61></a>                    <span class=n>metadata</span><span class=o>=</span><span class=p>{</span><span class=s2>"content_filtered"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
</span><span id=__span-28-62><a id=__codelineno-28-62 name=__codelineno-28-62 href=#__codelineno-28-62></a>                <span class=p>)</span>
</span><span id=__span-28-63><a id=__codelineno-28-63 name=__codelineno-28-63 href=#__codelineno-28-63></a>
</span><span id=__span-28-64><a id=__codelineno-28-64 name=__codelineno-28-64 href=#__codelineno-28-64></a>        <span class=k>return</span> <span class=n>PluginResult</span><span class=p>(</span><span class=n>continue_processing</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></code></pre></div> <h2 id=testing>Testing<a class=headerlink href=#testing title="Permanent link">¶</a></h2> <h3 id=testing-framework-integration>Testing Framework Integration<a class=headerlink href=#testing-framework-integration title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-29-1><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=c1># Example plugin test</span>
</span><span id=__span-29-2><a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=k>class</span><span class=w> </span><span class=nc>TestPIIFilterPlugin</span><span class=p>:</span>
</span><span id=__span-29-3><a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>test_pii_detection_and_masking</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-29-4><a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>        <span class=n>config</span> <span class=o>=</span> <span class=n>PluginConfig</span><span class=p>(</span>
</span><span id=__span-29-5><a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>            <span class=n>name</span><span class=o>=</span><span class=s2>"test_pii"</span><span class=p>,</span>
</span><span id=__span-29-6><a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a>            <span class=n>kind</span><span class=o>=</span><span class=s2>"plugins.pii_filter.pii_filter.PIIFilterPlugin"</span><span class=p>,</span>
</span><span id=__span-29-7><a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a>            <span class=n>hooks</span><span class=o>=</span><span class=p>[</span><span class=n>HookType</span><span class=o>.</span><span class=n>PROMPT_PRE_FETCH</span><span class=p>],</span>
</span><span id=__span-29-8><a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a>            <span class=n>config</span><span class=o>=</span><span class=p>{</span><span class=s2>"detect_ssn"</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>"mask_strategy"</span><span class=p>:</span> <span class=s2>"partial"</span><span class=p>}</span>
</span><span id=__span-29-9><a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a>        <span class=p>)</span>
</span><span id=__span-29-10><a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>
</span><span id=__span-29-11><a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a>        <span class=n>plugin</span> <span class=o>=</span> <span class=n>PIIFilterPlugin</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span><span id=__span-29-12><a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a>        <span class=n>payload</span> <span class=o>=</span> <span class=n>PromptPrehookPayload</span><span class=p>(</span>
</span><span id=__span-29-13><a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a>            <span class=n>name</span><span class=o>=</span><span class=s2>"test"</span><span class=p>,</span>
</span><span id=__span-29-14><a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a>            <span class=n>args</span><span class=o>=</span><span class=p>{</span><span class=s2>"user_input"</span><span class=p>:</span> <span class=s2>"My SSN is 123-45-6789"</span><span class=p>}</span>
</span><span id=__span-29-15><a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a>        <span class=p>)</span>
</span><span id=__span-29-16><a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a>        <span class=n>context</span> <span class=o>=</span> <span class=n>PluginContext</span><span class=p>(</span><span class=n>request_id</span><span class=o>=</span><span class=s2>"test-123"</span><span class=p>)</span>
</span><span id=__span-29-17><a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a>
</span><span id=__span-29-18><a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a>        <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>plugin</span><span class=o>.</span><span class=n>prompt_pre_fetch</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>
</span><span id=__span-29-19><a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a>
</span><span id=__span-29-20><a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a>        <span class=k>assert</span> <span class=n>result</span><span class=o>.</span><span class=n>continue_processing</span>
</span><span id=__span-29-21><a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>        <span class=k>assert</span> <span class=s2>"XXX-XX-6789"</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>modified_payload</span><span class=o>.</span><span class=n>args</span><span class=p>[</span><span class=s2>"user_input"</span><span class=p>]</span>
</span></code></pre></div> <h2 id=platform-agnostic-design>Platform-Agnostic Design<a class=headerlink href=#platform-agnostic-design title="Permanent link">¶</a></h2> <p>The plugin framework is designed as a <strong>reusable, standalone ecosystem</strong> that can be embedded in any application requiring extensible middleware processing.</p> <h3 id=framework-portability>Framework Portability<a class=headerlink href=#framework-portability title="Permanent link">¶</a></h3> <pre class=mermaid><code>flowchart TD
    subgraph "Core Framework (Portable)"
        Framework["Plugin Framework\\n(Python Package)"]
        Interface["Plugin Interface\\n(Language Agnostic)"]
        Protocol["MCP Protocol\\n(Cross-Platform)"]
    end

    subgraph "Host Applications"
        MCPGateway["MCP Gateway\\n(Primary Use Case)"]
        WebFramework["FastAPI/Flask App"]
        CLITool["CLI Application"]
        Microservice["Microservice"]
        DataPipeline["Data Pipeline"]
    end

    Framework --&gt; Interface
    Interface --&gt; Protocol

    Framework --&gt; MCPGateway
    Framework --&gt; WebFramework
    Framework --&gt; CLITool
    Framework --&gt; Microservice
    Framework --&gt; DataPipeline

    style Framework fill:#fff3e0
    style Protocol fill:#e8f5e8
    style MCPGateway fill:#e3f2fd</code></pre> <h3 id=integration-patterns>Integration Patterns<a class=headerlink href=#integration-patterns title="Permanent link">¶</a></h3> <h4 id=framework-as-python-package>Framework as Python Package<a class=headerlink href=#framework-as-python-package title="Permanent link">¶</a></h4> <div class="language-python highlight"><pre><span></span><code><span id=__span-30-1><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=c1># Any Python application can embed the plugin framework</span>
</span><span id=__span-30-2><a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=kn>from</span><span class=w> </span><span class=nn>mcpgateway.plugins</span><span class=w> </span><span class=kn>import</span> <span class=n>PluginManager</span><span class=p>,</span> <span class=n>PluginConfig</span>
</span><span id=__span-30-3><a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>
</span><span id=__span-30-4><a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=k>class</span><span class=w> </span><span class=nc>MyApplication</span><span class=p>:</span>
</span><span id=__span-30-5><a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-30-6><a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>plugin_manager</span> <span class=o>=</span> <span class=n>PluginManager</span><span class=p>(</span>
</span><span id=__span-30-7><a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>            <span class=n>config_path</span><span class=o>=</span><span class=s2>"/path/to/plugins.yaml"</span><span class=p>,</span>
</span><span id=__span-30-8><a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>            <span class=n>timeout</span><span class=o>=</span><span class=mi>30</span>
</span><span id=__span-30-9><a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>        <span class=p>)</span>
</span><span id=__span-30-10><a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a>
</span><span id=__span-30-11><a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>process_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span><span id=__span-30-12><a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>        <span class=n>payload</span> <span class=o>=</span> <span class=n>RequestPayload</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-30-13><a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>        <span class=n>context</span> <span class=o>=</span> <span class=n>GlobalContext</span><span class=p>(</span><span class=n>request_id</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span><span id=__span-30-14><a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>
</span><span id=__span-30-15><a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a>        <span class=c1># Pre-processing with plugins</span>
</span><span id=__span-30-16><a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a>        <span class=n>result</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>plugin_manager</span><span class=o>.</span><span class=n>custom_pre_hook</span><span class=p>(</span>
</span><span id=__span-30-17><a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a>            <span class=n>payload</span><span class=p>,</span> <span class=n>context</span>
</span><span id=__span-30-18><a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a>        <span class=p>)</span>
</span><span id=__span-30-19><a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a>
</span><span id=__span-30-20><a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>result</span><span class=o>.</span><span class=n>continue_processing</span><span class=p>:</span>
</span><span id=__span-30-21><a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a>            <span class=k>return</span> <span class=n>ErrorResponse</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>violation</span><span class=o>.</span><span class=n>description</span><span class=p>)</span>
</span><span id=__span-30-22><a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a>
</span><span id=__span-30-23><a id=__codelineno-30-23 name=__codelineno-30-23 href=#__codelineno-30-23></a>        <span class=c1># Your application logic here</span>
</span><span id=__span-30-24><a id=__codelineno-30-24 name=__codelineno-30-24 href=#__codelineno-30-24></a>        <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>process_business_logic</span><span class=p>(</span>
</span><span id=__span-30-25><a id=__codelineno-30-25 name=__codelineno-30-25 href=#__codelineno-30-25></a>            <span class=n>result</span><span class=o>.</span><span class=n>modified_payload</span> <span class=ow>or</span> <span class=n>payload</span>
</span><span id=__span-30-26><a id=__codelineno-30-26 name=__codelineno-30-26 href=#__codelineno-30-26></a>        <span class=p>)</span>
</span><span id=__span-30-27><a id=__codelineno-30-27 name=__codelineno-30-27 href=#__codelineno-30-27></a>
</span><span id=__span-30-28><a id=__codelineno-30-28 name=__codelineno-30-28 href=#__codelineno-30-28></a>        <span class=k>return</span> <span class=n>response</span>
</span></code></pre></div> <h3 id=language-interoperability>Language Interoperability<a class=headerlink href=#language-interoperability title="Permanent link">¶</a></h3> <p>The MCP-based external plugin system enables development in multiple languages:</p> <div class="language-yaml highlight"><pre><span></span><code><span id=__span-31-1><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># Multi-language plugin deployment</span>
</span><span id=__span-31-2><a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=nt>plugins</span><span class=p>:</span>
</span><span id=__span-31-3><a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=w>  </span><span class=c1># Python native plugin</span>
</span><span id=__span-31-4><a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"FastValidation"</span>
</span><span id=__span-31-5><a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"internal.validators.FastValidator"</span>
</span><span id=__span-31-6><a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>
</span><span id=__span-31-7><a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=w>  </span><span class=c1># TypeScript/Node.js plugin</span>
</span><span id=__span-31-8><a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"OpenAIModerationTS"</span>
</span><span id=__span-31-9><a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span>
</span><span id=__span-31-10><a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-31-11><a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STREAMABLEHTTP"</span>
</span><span id=__span-31-12><a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>"http://nodejs-plugin:3000/mcp"</span>
</span><span id=__span-31-13><a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a>
</span><span id=__span-31-14><a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a><span class=w>  </span><span class=c1># Go plugin</span>
</span><span id=__span-31-15><a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"HighPerformanceFilter"</span>
</span><span id=__span-31-16><a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span>
</span><span id=__span-31-17><a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-31-18><a id=__codelineno-31-18 name=__codelineno-31-18 href=#__codelineno-31-18></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STDIO"</span>
</span><span id=__span-31-19><a id=__codelineno-31-19 name=__codelineno-31-19 href=#__codelineno-31-19></a><span class=w>      </span><span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=s>"/opt/plugins/go-filter"</span>
</span><span id=__span-31-20><a id=__codelineno-31-20 name=__codelineno-31-20 href=#__codelineno-31-20></a>
</span><span id=__span-31-21><a id=__codelineno-31-21 name=__codelineno-31-21 href=#__codelineno-31-21></a><span class=w>  </span><span class=c1># Rust plugin</span>
</span><span id=__span-31-22><a id=__codelineno-31-22 name=__codelineno-31-22 href=#__codelineno-31-22></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>"CryptoValidator"</span>
</span><span id=__span-31-23><a id=__codelineno-31-23 name=__codelineno-31-23 href=#__codelineno-31-23></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=s>"external"</span>
</span><span id=__span-31-24><a id=__codelineno-31-24 name=__codelineno-31-24 href=#__codelineno-31-24></a><span class=w>    </span><span class=nt>mcp</span><span class=p>:</span>
</span><span id=__span-31-25><a id=__codelineno-31-25 name=__codelineno-31-25 href=#__codelineno-31-25></a><span class=w>      </span><span class=nt>proto</span><span class=p>:</span><span class=w> </span><span class=s>"STREAMABLEHTTP"</span>
</span><span id=__span-31-26><a id=__codelineno-31-26 name=__codelineno-31-26 href=#__codelineno-31-26></a><span class=w>      </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s>"http://rust-plugin:8080/mcp"</span>
</span></code></pre></div> <h2 id=future-extensions>Future Extensions<a class=headerlink href=#future-extensions title="Permanent link">¶</a></h2> <p>Legend: ✅ = Completed | 🚧 = In Progress | 📋 = Planned</p> <h3 id=planned-hook-points>Planned Hook Points<a class=headerlink href=#planned-hook-points title="Permanent link">¶</a></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-32-1><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=c1># HTTP hooks</span>
</span><span id=__span-32-2><a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=n>HTTP_PRE_FORWARDING_CALL</span> <span class=o>=</span> <span class=s2>"http_pre_forwarding_call"</span>   <span class=c1># Before HTTP forwarding</span>
</span><span id=__span-32-3><a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=n>HTTP_POST_FORWARDING_CALL</span> <span class=o>=</span> <span class=s2>"http_post_forwarding_call"</span> <span class=c1># After HTTP forwarding</span>
</span><span id=__span-32-4><a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a>
</span><span id=__span-32-5><a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=c1># Server lifecycle hooks</span>
</span><span id=__span-32-6><a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=n>SERVER_PRE_REGISTER</span> <span class=o>=</span> <span class=s2>"server_pre_register"</span>    <span class=c1># Server attestation and validation</span>
</span><span id=__span-32-7><a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=n>SERVER_POST_REGISTER</span> <span class=o>=</span> <span class=s2>"server_post_register"</span>  <span class=c1># Post-registration processing</span>
</span><span id=__span-32-8><a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>
</span><span id=__span-32-9><a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a><span class=c1># Authentication hooks</span>
</span><span id=__span-32-10><a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a><span class=n>AUTH_PRE_CHECK</span> <span class=o>=</span> <span class=s2>"auth_pre_check"</span>              <span class=c1># Custom authentication logic</span>
</span><span id=__span-32-11><a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=n>AUTH_POST_CHECK</span> <span class=o>=</span> <span class=s2>"auth_post_check"</span>            <span class=c1># Post-authentication processing</span>
</span><span id=__span-32-12><a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>
</span><span id=__span-32-13><a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a><span class=c1># Federation hooks</span>
</span><span id=__span-32-14><a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a><span class=n>FEDERATION_PRE_SYNC</span> <span class=o>=</span> <span class=s2>"federation_pre_sync"</span>    <span class=c1># Pre-federation validation</span>
</span><span id=__span-32-15><a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a><span class=n>FEDERATION_POST_SYNC</span> <span class=o>=</span> <span class=s2>"federation_post_sync"</span>  <span class=c1># Post-federation processing</span>
</span></code></pre></div> <h3 id=external-service-integrations>External Service Integrations<a class=headerlink href=#external-service-integrations title="Permanent link">¶</a></h3> <h4 id=current-integrations>Current Integrations<a class=headerlink href=#current-integrations title="Permanent link">¶</a></h4> <ul> <li>✅ <strong>Open Policy Agent (OPA):</strong> Policy-as-code enforcement engine</li> <li>✅ <strong>LlamaGuard:</strong> Content safety classification and filtering</li> <li>✅ <strong>OpenAI Moderation API:</strong> Commercial content moderation</li> <li>✅ <strong>Custom MCP Servers:</strong> Any language, any protocol</li> </ul> <h4 id=planned-integrations-phase-2-3>Planned Integrations (Phase 2-3)<a class=headerlink href=#planned-integrations-phase-2-3 title="Permanent link">¶</a></h4> <ul> <li>🚧 <strong>HashiCorp Vault:</strong> Secret management for plugin configurations</li> <li>🚧 <strong>SPIFFE/SPIRE:</strong> Workload identity and attestation</li> <li>📋 <strong>AWS GuardDuty:</strong> Cloud security monitoring integration</li> <li>📋 <strong>Azure Cognitive Services:</strong> Enterprise AI services</li> <li>📋 <strong>Google Cloud AI:</strong> ML model integration</li> <li>📋 <strong>Kubernetes Operators:</strong> Native K8s plugin deployment</li> <li>📋 <strong>Istio/Envoy:</strong> Service mesh integration</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 17, 2025 11:11:57 UTC">October 17, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 5.5A3.5 3.5 0 0 1 15.5 9a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 9 3.5 3.5 0 0 1 12 5.5M5 8c.56 0 1.08.15 1.53.42-.15 1.43.27 2.85 1.13 3.96C7.16 13.34 6.16 14 5 14a3 3 0 0 1-3-3 3 3 0 0 1 3-3m14 0a3 3 0 0 1 3 3 3 3 0 0 1-3 3c-1.16 0-2.16-.66-2.66-1.62a5.54 5.54 0 0 0 1.13-3.96c.45-.27.97-.42 1.53-.42M5.5 18.25c0-2.07 2.91-3.75 6.5-3.75s6.5 1.68 6.5 3.75V20h-13zM0 20v-1.5c0-1.39 1.89-2.56 4.45-2.9-.59.68-.95 1.62-.95 2.65V20zm24 0h-3.5v-1.75c0-1.03-.36-1.97-.95-2.65 2.56.34 4.45 1.51 4.45 2.9z"></path></svg> </span> <nav> <a href=mailto:araujof@users.noreply.github.com>Frederico Araujo</a>, <a href=mailto:crivetimihai@gmail.com>Mihai Criveti</a>, <a href=mailto:30874627+terylt@users.noreply.github.com>terylt</a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Apache 2.0 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/IBM/mcp-context-forge target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.feedback", "content.code.annotate", "content.code.copy", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.share", "search.suggest", "toc.integrate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.92b07e13.min.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>